/************************************************************************
Name: XElement
Version: 8.0.0
License: MPL-2.0
Author: Alexander Elias
Email: alex.steven.elis@gmail.com
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
************************************************************************/
var k=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var p=(e,t,n)=>(k(e,t,"read from private field"),n?n.call(e):t.get(e)),C=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},N=(e,t,n,i)=>(k(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);var j=(e,t,n)=>(k(e,t,"access private method"),n);var x=(e,t,n)=>new Promise((i,o)=>{var a=s=>{try{h(n.next(s))}catch(u){o(u)}},d=s=>{try{h(n.throw(s))}catch(u){o(u)}},h=s=>s.done?i(s.value):Promise.resolve(s.value).then(a,d);h((n=n.apply(e,t)).next())});function P(e,t){customElements.get(e)||customElements.define(e,t)}function W(e){switch(typeof e){case"undefined":return"";case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e);default:throw new Error("XElement - display type not handled")}}var F=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t!=null&&t.length)for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)},B=function(e,t){return e.indexOf(t)!==-1},Y="trustedTypes"in window?window.trustedTypes.createPolicy("x-element",{createHTML:e=>e}):null,Q=function(e){return Y?Y.createHTML(e):e};var M=Symbol("html"),ee=new WeakMap;function O(e,...t){let n=ee.get(e);if(n)return{strings:e,template:n,expressions:t,symbol:M};{let i="",o=e.length-1;for(let d=0;d<o;d++)i+=`${e[d]}{{${d}}}`;i+=e[o];let a=document.createElement("template");return a.innerHTML=Q(i),ee.set(e,a),{strings:e,template:a,expressions:t,symbol:M}}}var we=NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,te=["src","href","xlink:href"],Ce=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ne=function(e){return typeof e!="string"||!Ce.test(e)},ge=function(e,t){var i;let n=t.previousSibling;for(;n!==e;)(i=n==null?void 0:n.parentNode)==null||i.removeChild(n),n=t.previousSibling},oe=function(e,t){var n,i,o,a,d,h,s,u,E,b,r,l;if((t==null?void 0:t.symbol)===M)if(e=e!=null?e:{},t=t!=null?t:{},e.strings===t.strings){let c=this.actions.length;for(let m=0;m<c;m++)this.actions[m](e.expressions[m],t.expressions[m])}else{let c=t.template.content.cloneNode(!0);ie(c,this.actions);let m=this.actions.length;for(let v=0;v<m;v++)this.actions[v]((n=e.expressions)==null?void 0:n[v],t.expressions[v]);document.adoptNode(c),ge(this.start,this.end),(i=this.end.parentNode)==null||i.insertBefore(c,this.end)}else if((t==null?void 0:t.constructor)===Array){e=e!=null?e:[],t=t!=null?t:[];let c=e.length,m=t.length,v=Math.min(c,m);for(let f=0;f<v;f++)this.actions[f](e[f],t[f]);if(c<m){let f=document.createElement("template");for(let A=c;A<m;A++){let D=document.createTextNode(""),G=document.createTextNode(""),J=oe.bind({start:D,end:G,actions:[]});f.content.appendChild(D),f.content.appendChild(G),this.actions.push(J),J(e[A],t[A])}(o=this.end.parentNode)==null||o.insertBefore(f.content,this.end)}else if(c>m){for(let f=c-1;f>m-1;f--)if(((a=e[f])==null?void 0:a.symbol)===M){let{template:A}=e[f],D=A.content.childNodes.length+2;for(;D--;)(d=this.end.parentNode)==null||d.removeChild(this.end.previousSibling)}else(h=this.end.parentNode)==null||h.removeChild(this.end.previousSibling),(s=this.end.parentNode)==null||s.removeChild(this.end.previousSibling),(u=this.end.parentNode)==null||u.removeChild(this.end.previousSibling);this.actions.length=m}}else{if(e===t)return;for(;this.end.previousSibling!==this.start;)(E=this.end.parentNode)==null||E.removeChild(this.end.previousSibling);let c;this.end.previousSibling===this.start?(c=document.createTextNode(t),(b=this.end.parentNode)==null||b.insertBefore(c,this.end)):this.end.previousSibling.nodeType===Node.TEXT_NODE?(c=this.end.previousSibling,c.textContent=t):(c=document.createTextNode(t),(r=this.end.parentNode)==null||r.removeChild(this.end.previousSibling),(l=this.end.parentNode)==null||l.insertBefore(c,this.end))}},Ne=function(e,t){e!==t&&(this.element.removeAttribute(e),this.name=t==null?void 0:t.toLowerCase(),this.name&&this.element.setAttribute(this.name,""))},Te=function(e,t){if(e!==t)if(this.name==="value")this.value=W(t),Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value);else if(this.name.startsWith("on")){if(typeof e=="function"&&this.element.removeEventListener(this.name.slice(2),e),this.value=t,typeof this.value!="function")return console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);this.element.addEventListener(this.name.slice(2),this.value)}else if(B(te,this.name)){if(this.value=encodeURI(t),ne(this.value)){this.element.removeAttribute(this.name),console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);return}Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else this.value=t,this.name&&(Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value))},ie=function(e,t){var a,d,h,s,u,E,b;let n=document.createTreeWalker(document,we,null);n.currentNode=e;let i=0,o=e.firstChild;for(;(o=n.nextNode())!==null;)if(o.nodeType===Node.TEXT_NODE){let r=(d=(a=o.nodeValue)==null?void 0:a.indexOf("{{"))!=null?d:-1;if(r==-1)continue;r!=0&&(o.splitText(r),o=n.nextNode());let l=(s=(h=o.nodeValue)==null?void 0:h.indexOf("}}"))!=null?s:-1;if(l==-1)continue;l+2!=((u=o.nodeValue)==null?void 0:u.length)&&o.splitText(l+2),i++;let c=document.createTextNode(""),m=o;m.textContent="",(E=m.parentNode)==null||E.insertBefore(c,m),t.push(oe.bind({start:c,end:m,actions:[]}))}else if(o.nodeType===Node.ELEMENT_NODE){(o.nodeName==="SCRIPT"||o.nodeName==="STYLE")&&n.nextSibling();let r=o.getAttributeNames();for(let l of r){let c=(b=o.getAttribute(l))!=null?b:"",m=l.includes("{{")&&l.includes("}}"),v=c.includes("{{")&&c.includes("}}");if(m||v){let f={element:o,name:l,value:c};m&&(i++,o.removeAttribute(l),t.push(Ne.bind(f))),v&&(i++,o.removeAttribute(l),t.push(Te.bind(f)))}else B(te,l)?ne(c)&&(o.removeAttribute(l),console.warn(`XElement - attribute name "${l}" and value "${c}" not allowed`)):l.startsWith("on")&&(o.removeAttribute(l),console.warn(`XElement - attribute name "${l}" not allowed`))}}else console.warn(`XElement - node type "${o.nodeType}" not handled`)},se=ie;var re=function(e,t,n,i,o){if(typeof n=="symbol")return Reflect.set(t,n,i,o);let a=Reflect.get(t,n,o);return a===i||Number.isNaN(a)&&Number.isNaN(i)||(Reflect.set(t,n,i,o),e()),!0},ce=function(e,t,n,i){var a,d,h,s;if(typeof n=="symbol")return Reflect.get(t,n,i);let o=Reflect.get(t,n,i);return((a=o==null?void 0:o.constructor)==null?void 0:a.name)==="Object"||((d=o==null?void 0:o.constructor)==null?void 0:d.name)==="Array"?new Proxy(o,{get:ce.bind(null,e),set:re.bind(null,e),deleteProperty:ae.bind(null,e)}):((h=o==null?void 0:o.constructor)==null?void 0:h.name)==="Function"||((s=o==null?void 0:o.constructor)==null?void 0:s.name)==="AsyncFunction"?new Proxy(o,{apply:(u,E,b)=>Reflect.apply(u,i,b)}):o},ae=function(e,t,n){return typeof n=="symbol"?Reflect.deleteProperty(t,n):(Reflect.deleteProperty(t,n),e(),!0)},Re=function(e,t){return new Proxy(e,{get:ce.bind(null,t),set:re.bind(null,t),deleteProperty:ae.bind(null,t)})},de=Re;function S(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e}var le=new Event("adopted"),he=new Event("adopting"),Be=new Event("upgraded"),Ie=new Event("upgrading"),pe=new Event("creating"),me=new Event("created"),I=new Event("rendering"),_=new Event("rendered"),ue=new Event("connected"),fe=new Event("connecting"),ye=new Event("attributed"),Ee=new Event("attributing"),xe=new Event("disconnected"),be=new Event("disconnecting");var w=Symbol("change"),H,y,$,T,L,R,Ae,X,q,V,ve,g=class extends HTMLElement{constructor(){var o;super();C(this,X);C(this,V);C(this,H,!1);C(this,y,{});C(this,$,void 0);C(this,T,[]);C(this,L,[]);C(this,R,void 0);this[Ae]=void 0;let n=this.constructor;if(n.shadow&&!this.shadowRoot){let a=n.mode||"open";this.attachShadow({mode:a})}N(this,$,(o=this.shadowRoot)!=null?o:this)}static define(n=(i=>(i=this.tag)!=null?i:this.name)()){return n=S(n),P(n,this),this}static create(){return x(this,arguments,function*(n=(i=>(i=this.tag)!=null?i:this.name)()){n=S(n),P(n,this);let o=document.createElement(n);return yield o[w],o})}attributeChangedCallback(n,i,o){return x(this,null,function*(){var a,d;this.dispatchEvent(Ee),yield(d=(a=this.attribute)==null?void 0:a.call(this,n,i,o))==null?void 0:d.catch(console.error),this.dispatchEvent(ye)})}adoptedCallback(){return x(this,null,function*(){var n,i;this.dispatchEvent(he),yield(i=(n=this.adopted)==null?void 0:n.call(this,p(this,y)))==null?void 0:i.catch(console.error),this.dispatchEvent(le)})}connectedCallback(){return x(this,null,function*(){var n,i;p(this,H)||(N(this,H,!0),this[w]=j(this,V,ve).call(this),yield this[w]),this.dispatchEvent(fe),yield(i=(n=this.connected)==null?void 0:n.call(this,p(this,y)))==null?void 0:i.catch(console.error),this.dispatchEvent(ue)})}disconnectedCallback(){return x(this,null,function*(){var n,i;this.dispatchEvent(be),yield(i=(n=this.disconnected)==null?void 0:n.call(this,p(this,y)))==null?void 0:i.catch(console.error),this.dispatchEvent(xe)})}};Ae=w,H=new WeakMap,y=new WeakMap,$=new WeakMap,T=new WeakMap,L=new WeakMap,R=new WeakMap,X=new WeakSet,q=function(){return x(this,null,function*(){let n=()=>x(this,null,function*(){var o,a,d;this.dispatchEvent(I);let i=yield(o=this.render)==null?void 0:o.call(this,p(this,y));if(i)for(let h=0;h<p(this,T).length;h++){let s=i.expressions[h],u=p(this,L)[h];p(this,T)[h](u,s),p(this,L)[h]=i.expressions[h]}yield(a=this.rendered)==null?void 0:a.call(this,p(this,y)),this.dispatchEvent(_),this[w]=(d=p(this,R))==null?void 0:d.call(this),N(this,R,void 0),yield this[w]});this[w]?N(this,R,n):this[w]=n()})},V=new WeakSet,ve=function(){return x(this,null,function*(){var h,s,u,E,b;let i=this.constructor.observedProperties,o=Object.getPrototypeOf(this),a=i?i!=null?i:[]:[...Object.getOwnPropertyNames(this),...Object.getOwnPropertyNames(o)];for(let r of a){if(r==="attributeChangedCallback"||r==="disconnectedCallback"||r==="connectedCallback"||r==="adoptedCallback"||r==="constructor"||r==="disconnected"||r==="attribute"||r==="connected"||r==="rendered"||r==="created"||r==="adopted"||r==="render"||r==="setup")continue;let l=(h=Object.getOwnPropertyDescriptor(this,r))!=null?h:Object.getOwnPropertyDescriptor(o,r);l&&l.configurable&&(Object.defineProperty(p(this,y),r,l),Object.defineProperty(this,r,{enumerable:l.enumerable,configurable:!1,get(){return p(this,y)[r]},set(c){p(this,y)[r]=c,j(this,X,q).call(this)}}))}N(this,y,de(p(this,y),j(this,X,q).bind(this))),this.dispatchEvent(I);let d=yield(s=this.render)==null?void 0:s.call(this,p(this,y));if(d){let r=d.template.content.cloneNode(!0);N(this,L,d.expressions),se(r,p(this,T));for(let l=0;l<p(this,T).length;l++){let c=d.expressions[l];p(this,T)[l](void 0,c)}document.adoptNode(r),p(this,$).appendChild(r)}yield(u=this.rendered)==null?void 0:u.call(this,p(this,y)),this.dispatchEvent(_),this[w]=(E=p(this,R))==null?void 0:E.call(this),N(this,R,void 0),yield this[w],this.dispatchEvent(pe),yield(b=this.created)==null?void 0:b.call(this,p(this,y)),this.dispatchEvent(me)})},g.html=O;var K=[],U=[],z=function(e){return x(this,null,function*(){var t,n;if(e.instance)F(e.root,e.instance);else{let i=yield e.handler();if((i==null?void 0:i.prototype)instanceof HTMLElement)e.construct=i;else if(((t=i==null?void 0:i.default)==null?void 0:t.prototype)instanceof HTMLElement)e.construct=i.default;else throw new Error("XElement - router handler requires a CustomElementConstructor");e.construct.prototype instanceof g?e.instance=yield e.construct.create():(e.tag=S((n=e.construct.tag)!=null?n:e.construct.name),P(e.tag,e.construct),e.instance=document.createElement(e.tag)),F(e.root,e.instance)}})},Pe=function(e){var a,d,h;if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL((a=e==null?void 0:e.destination.url)!=null?a:location.href),n=new URL((h=(d=document.querySelector("base"))==null?void 0:d.href)!=null?h:location.origin);n.hash="",n.search="",t.hash="",t.search="";let i=t.href.replace(n.href,"/"),o=[];for(let s of U)s.path===i&&o.push(s);for(let s of K){let u=!1;for(let E of o)if(E.root===s.root){u=!0;break}u||o.push(s)}if(e!=null&&e.intercept)return e.intercept({handler:()=>o.map(s=>z(s))});if(e!=null&&e.transitionWhile)return e.transitionWhile(o.map(s=>z(s)));o.map(s=>z(s))},Se=function(e,t,n){if(!e)throw new Error("XElement - router path required");if(!n)throw new Error("XElement - router handler required");if(!t)throw new Error("XElement - router root required");if(e==="/*"){for(let i of K)if(i.path===e&&i.root===t)throw new Error("XElement - router duplicate path on root");K.push({path:e,root:t,handler:n})}else{for(let i of U)if(i.path===e&&i.root===t)throw new Error("XElement - router duplicate path on root");U.push({path:e,root:t,handler:n,instance:void 0})}Reflect.get(window,"navigation").addEventListener("navigate",Pe)},Z=Se;var at={Component:g,component:g,Router:Z,router:Z,html:O};export{g as Component,Z as Router,g as component,at as default,O as html,Z as router};
//# sourceMappingURL=x-element.min.js.map
