/************************************************************************
Name: XElement
Version: 8.1.3
License: MPL-2.0
Author: Alexander Elias
Email: alex.steven.elis@gmail.com
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
************************************************************************/
var B=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var u=(e,t,n)=>(B(e,t,"read from private field"),n?n.call(e):t.get(e)),C=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},v=(e,t,n,o)=>(B(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var Q=(e,t,n)=>(B(e,t,"access private method"),n);var w=(e,t,n)=>new Promise((o,s)=>{var i=r=>{try{d(n.next(r))}catch(m){s(m)}},c=r=>{try{d(n.throw(r))}catch(m){s(m)}},d=r=>r.done?o(r.value):Promise.resolve(r.value).then(i,c);d((n=n.apply(e,t)).next())});function S(e,t){customElements.get(e)||customElements.define(e,t)}function q(e){switch(typeof e){case"undefined":return"";case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e);default:throw new Error("XElement - display type not handled")}}var ee=()=>Math.floor(Math.random()*Date.now());var _=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t!=null&&t.length)for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)},I=function(e,t){return e.indexOf(t)!==-1},te="trustedTypes"in window?window.trustedTypes.createPolicy("x-element",{createHTML:e=>e}):null,ne=function(e){return te?te.createHTML(e):e};var $=Symbol("html"),oe=new WeakMap;function H(e,...t){let n=oe.get(e);if(n){let[o,s]=n;return{strings:e,template:o,expressions:t,symbol:$,marker:s}}else{let o=`X-${ee()}-X`,s="",i=e.length-1;for(let d=0;d<i;d++)s+=`${e[d]}${o}`;s+=e[i];let c=document.createElement("template");return c.innerHTML=ne(s),oe.set(e,[c,o]),{strings:e,template:c,expressions:t,symbol:$,marker:o}}}var Ne=NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,ie=["src","href","xlink:href"],Te=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,se=function(e){return e===""||typeof e!="string"?!1:!Te.test(e)},Re=function(e,t){var o;let n=t.previousSibling;for(;n!==e;)(o=n==null?void 0:n.parentNode)==null||o.removeChild(n),n=t.previousSibling},re=function(e,t){var n,o,s,i,c,d,r,m,x,l,a,b,p;if((t==null?void 0:t.symbol)===$)if(e=e!=null?e:{},t=t!=null?t:{},e.strings===t.strings){let h=this.actions.length;for(let f=0;f<h;f++)this.actions[f](e.expressions[f],t.expressions[f])}else{this.actions.length=0;let h=t.template.content.cloneNode(!0);ae(h,this.actions,t.marker);let f=this.actions.length;for(let g=0;g<f;g++)this.actions[g]((n=e.expressions)==null?void 0:n[g],t.expressions[g]);document.adoptNode(h),Re(this.start,this.end),(o=this.end.parentNode)==null||o.insertBefore(h,this.end)}else if((t==null?void 0:t.constructor)===Array){e=e!=null?e:[],t=t!=null?t:[];let h=e.length,f=t.length,g=Math.min(h,f);for(let y=0;y<g;y++)this.actions[y](e[y],t[y]);if(h<f){let y=document.createElement("template");for(let M=h;M<f;M++){let W=document.createTextNode(""),J=document.createTextNode(""),Y=re.bind({start:W,end:J,actions:[]});y.content.appendChild(W),y.content.appendChild(J),this.actions.push(Y),Y(e[M],t[M])}(s=this.end.parentNode)==null||s.insertBefore(y.content,this.end)}else if(h>f){for(let y=h-1;y>f-1;y--)if(((i=e[y])==null?void 0:i.symbol)===$){let{template:M}=e[y],W=M.content.childNodes.length+2;for(;W--;)(c=this.end.parentNode)==null||c.removeChild(this.end.previousSibling)}else(d=this.end.parentNode)==null||d.removeChild(this.end.previousSibling),(r=this.end.parentNode)==null||r.removeChild(this.end.previousSibling),(m=this.end.parentNode)==null||m.removeChild(this.end.previousSibling);this.actions.length=f}}else{if(e===t)return;if(typeof e!=typeof t)for(;this.end.previousSibling!==this.start;)(x=this.end.parentNode)==null||x.removeChild(this.end.previousSibling);let h;this.end.previousSibling===this.start?(h=document.createTextNode(t),(l=this.end.parentNode)==null||l.insertBefore(h,this.end)):((a=this.end.previousSibling)==null?void 0:a.nodeType)===Node.TEXT_NODE?(h=this.end.previousSibling,h.textContent=t):(h=document.createTextNode(t),(b=this.end.parentNode)==null||b.removeChild(this.end.previousSibling),(p=this.end.parentNode)==null||p.insertBefore(h,this.end))}},Ae=function(e,t){e!==t&&(e!=null&&e.startsWith("on")&&typeof this.value=="function"&&this.element.removeEventListener(e.slice(2),this.value),Reflect.set(this.element,e,void 0),this.element.removeAttribute(e),this.name=t==null?void 0:t.toLowerCase(),this.name&&this.element.setAttribute(this.name,""))},Me=function(e,t){if(e!==t)if(this.name==="value"){if(this.value=q(t),!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else if(this.name.startsWith("on")){if(!this.name)return;if(typeof this.value=="function"&&this.element.removeEventListener(this.name.slice(2),this.value,!0),this.value=t,typeof this.value!="function")return console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);this.element.addEventListener(this.name.slice(2),this.value,!0)}else if(I(ie,this.name)){if(this.value=encodeURI(t),!this.name)return;if(se(this.value)){this.element.removeAttribute(this.name),console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);return}Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else{if(this.value=t,!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}},Se=function(e,t){var o,s,i,c;if(e===t)return;let n=this.element;if(t){(o=n.parentNode)==null||o.removeChild(n);let d=document.createElement(t);for(;n.firstChild;)d.appendChild(n.firstChild);if(n.nodeType===Node.ELEMENT_NODE){let r=n.getAttributeNames();for(let m of r){let x=(s=n.getAttribute(m))!=null?s:"";d.setAttribute(m,x)}}(i=this.holder.parentNode)==null||i.insertBefore(d,this.holder),this.element=d}else(c=n.parentNode)==null||c.removeChild(n),this.element=n},ae=function(e,t,n){var c,d,r,m,x,l;let o=new WeakSet,s=document.createTreeWalker(document,Ne,null);s.currentNode=e;let i=e.firstChild;for(;i=s.nextNode();)if(o.has(i.previousSibling)&&(o.delete(i.previousSibling),t.push(()=>{})),i.nodeType===Node.TEXT_NODE){let a=(d=(c=i.nodeValue)==null?void 0:c.indexOf(n))!=null?d:-1;if(a===-1)continue;a!==0&&(i.splitText(a),i=s.nextNode());let b=n.length;b!==((r=i.nodeValue)==null?void 0:r.length)&&i.splitText(b);let p=document.createTextNode(""),h=i;h.textContent="",(m=h.parentNode)==null||m.insertBefore(p,h),t.push(re.bind({marker:n,start:p,end:h,actions:[]}))}else if(i.nodeType===Node.ELEMENT_NODE){(i.nodeName==="SCRIPT"||i.nodeName==="STYLE")&&s.nextSibling();let a={element:i};i.nodeName===n&&(o.add(i),a.holder=document.createTextNode(""),(x=i.parentNode)==null||x.insertBefore(a.holder,i),t.push(Se.bind(a)));let b=i.getAttributeNames();for(let p of b){let h=(l=i.getAttribute(p))!=null?l:"",f=p.toUpperCase().includes(n),g=h.includes(n);if(f||g){let y={name:p,value:h,previous:void 0,get element(){return a.element}};f&&(i.removeAttribute(p),t.push(Ae.bind(y))),g&&(i.removeAttribute(p),t.push(Me.bind(y)))}else I(ie,p)?se(h)&&(i.removeAttribute(p),console.warn(`XElement - attribute name "${p}" and value "${h}" not allowed`)):p.startsWith("on")&&(i.removeAttribute(p),console.warn(`XElement - attribute name "${p}" not allowed`))}}else console.warn(`XElement - node type "${i.nodeType}" not handled`)},ce=ae;var le=function(e,t,n,o,s){if(typeof n=="symbol")return Reflect.set(t,n,o,s);let i=Reflect.get(t,n,s);return i===o||Number.isNaN(i)&&Number.isNaN(o)||(Reflect.set(t,n,o,s),e()),!0},de=function(e,t,n,o){if(typeof n=="symbol")return Reflect.get(t,n,o);let s=Reflect.get(t,n,o);return typeof s=="function"?new Proxy(s,{apply:(i,c,d)=>Reflect.apply(i,o,d)}):typeof s=="object"?new Proxy(s,{get:de.bind(null,e),set:le.bind(null,e),deleteProperty:he.bind(null,e)}):s},he=function(e,t,n){return typeof n=="symbol"?Reflect.deleteProperty(t,n):(Reflect.deleteProperty(t,n),e(),!0)},Le=function(e,t){return new Proxy(e,{get:de.bind(null,t),set:le.bind(null,t),deleteProperty:he.bind(null,t)})},ue=Le;function L(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e}var pe=new Event("adopted"),me=new Event("adopting"),Ue=new Event("upgraded"),Ze=new Event("upgrading"),fe=new Event("creating"),ye=new Event("created"),F=new Event("rendering"),z=new Event("rendered"),Ee=new Event("connected"),ve=new Event("connecting"),xe=new Event("attributed"),be=new Event("attributing"),we=new Event("disconnected"),ge=new Event("disconnecting");var P=Symbol("ChangeTask"),j=Symbol("ChangeRequest"),X,E,D,k,T,O,R,A,Pe,V,Ce,N=class extends HTMLElement{constructor(){var s;super();C(this,V);C(this,X,!1);C(this,E,{});C(this,D,void 0);C(this,k,"");C(this,T,[]);C(this,O,[]);C(this,R,!1);C(this,A,!1);this[Pe]=Promise.resolve();let n=this.constructor;if(n.shadow&&!this.shadowRoot){let i=n.mode||"open";this.attachShadow({mode:i})}v(this,D,(s=this.shadowRoot)!=null?s:this)}static define(n=(o=>(o=this.tag)!=null?o:this.name)()){return n=L(n),S(n,this),this}static create(){return w(this,arguments,function*(n=(o=>(o=this.tag)!=null?o:this.name)()){n=L(n),S(n,this);let s=document.createElement(n);return yield s[P],s})}attributeChangedCallback(n,o,s){return w(this,null,function*(){var i,c;this.dispatchEvent(be),yield(c=(i=this.attribute)==null?void 0:i.call(this,n,o,s))==null?void 0:c.catch(console.error),this.dispatchEvent(xe)})}adoptedCallback(){return w(this,null,function*(){var n,o;this.dispatchEvent(me),yield(o=(n=this.adopted)==null?void 0:n.call(this,u(this,E)))==null?void 0:o.catch(console.error),this.dispatchEvent(pe)})}connectedCallback(){return w(this,null,function*(){var n,o;u(this,X)||(v(this,X,!0),v(this,R,!0),yield Q(this,V,Ce).call(this)),this.dispatchEvent(ve),yield(o=(n=this.connected)==null?void 0:n.call(this,u(this,E)))==null?void 0:o.catch(console.error),this.dispatchEvent(Ee)})}disconnectedCallback(){return w(this,null,function*(){var n,o;this.dispatchEvent(ge),yield(o=(n=this.disconnected)==null?void 0:n.call(this,u(this,E)))==null?void 0:o.catch(console.error),this.dispatchEvent(we)})}[(Pe=P,j)](){return w(this,null,function*(){return u(this,R)?(v(this,A,!0),this[P]):(v(this,R,!0),this[P]=this[P].then(()=>w(this,null,function*(){var o,s;this.dispatchEvent(F);let n=yield(o=this.render)==null?void 0:o.call(this,u(this,E));if(n)for(let i=0;i<u(this,T).length;i++){if(u(this,A)){yield Promise.resolve().then().catch(console.error),i=-1,v(this,A,!1);continue}let c=n.expressions[i],d=u(this,O)[i];try{u(this,T)[i](d,c)}catch(r){console.error(r)}u(this,O)[i]=n.expressions[i]}v(this,R,!1),yield(s=this.rendered)==null?void 0:s.call(this,u(this,E)),this.dispatchEvent(z)})).catch(console.error),this[P])})}};X=new WeakMap,E=new WeakMap,D=new WeakMap,k=new WeakMap,T=new WeakMap,O=new WeakMap,R=new WeakMap,A=new WeakMap,V=new WeakSet,Ce=function(){return w(this,null,function*(){var d,r,m,x;let o=this.constructor.observedProperties,s=Object.getPrototypeOf(this),i=o?o!=null?o:[]:[...Object.getOwnPropertyNames(this),...Object.getOwnPropertyNames(s)];for(let l of i){if(l==="attributeChangedCallback"||l==="disconnectedCallback"||l==="connectedCallback"||l==="adoptedCallback"||l==="constructor"||l==="disconnected"||l==="attribute"||l==="connected"||l==="rendered"||l==="created"||l==="adopted"||l==="render"||l==="setup")continue;let a=(d=Object.getOwnPropertyDescriptor(this,l))!=null?d:Object.getOwnPropertyDescriptor(s,l);a&&a.configurable&&(typeof a.value=="function"&&(a.value=a.value.bind(this)),typeof a.get=="function"&&(a.get=a.get.bind(this)),typeof a.set=="function"&&(a.set=a.set.bind(this)),Object.defineProperty(u(this,E),l,a),Object.defineProperty(this,l,{enumerable:a.enumerable,configurable:!1,get(){return u(this,E)[l]},set(b){u(this,E)[l]=b,this[j]()}}))}v(this,E,ue(u(this,E),this[j].bind(this))),this.dispatchEvent(F);let c=yield(r=this.render)==null?void 0:r.call(this,u(this,E));if(c){let l=c.template.content.cloneNode(!0);v(this,k,c.marker),v(this,O,c.expressions),ce(l,u(this,T),u(this,k));for(let a=0;a<u(this,T).length;a++){let b=c.expressions[a];try{u(this,T)[a](void 0,b)}catch(p){console.error(p)}}document.adoptNode(l),u(this,D).appendChild(l)}yield(m=this.rendered)==null?void 0:m.call(this,u(this,E)),this.dispatchEvent(z),v(this,A,!1),v(this,R,!1),yield this[j](),this.dispatchEvent(fe),yield(x=this.created)==null?void 0:x.call(this,u(this,E)),this.dispatchEvent(ye)})},N.html=H;var U=[],Z=[],K=function(e){return w(this,null,function*(){var t,n;if(e.instance)_(e.root,e.instance);else{let o=yield e.handler();if((o==null?void 0:o.prototype)instanceof HTMLElement)e.construct=o;else if(((t=o==null?void 0:o.default)==null?void 0:t.prototype)instanceof HTMLElement)e.construct=o.default;else throw new Error("XElement - router handler requires a CustomElementConstructor");e.construct.prototype instanceof N?e.instance=yield e.construct.create():(e.tag=L((n=e.construct.tag)!=null?n:e.construct.name),S(e.tag,e.construct),e.instance=document.createElement(e.tag)),_(e.root,e.instance)}})},Oe=function(e){var i,c,d;if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL((i=e==null?void 0:e.destination.url)!=null?i:location.href),n=new URL((d=(c=document.querySelector("base"))==null?void 0:c.href)!=null?d:location.origin);n.hash="",n.search="",t.hash="",t.search="";let o=t.href.replace(n.href,"/"),s=[];for(let r of Z)r.path===o&&s.push(r);for(let r of U){let m=!1;for(let x of s)if(x.root===r.root){m=!0;break}m||s.push(r)}if(e!=null&&e.intercept)return e.intercept({handler:()=>s.map(r=>K(r))});if(e!=null&&e.transitionWhile)return e.transitionWhile(s.map(r=>K(r)));s.map(r=>K(r))},$e=function(e,t,n){if(!e)throw new Error("XElement - router path required");if(!n)throw new Error("XElement - router handler required");if(!t)throw new Error("XElement - router root required");if(e==="/*"){for(let o of U)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");U.push({path:e,root:t,handler:n})}else{for(let o of Z)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");Z.push({path:e,root:t,handler:n,instance:void 0})}Reflect.get(window,"navigation").addEventListener("navigate",Oe)},G=$e;var mt={Component:N,component:N,Router:G,router:G,html:H};export{N as Component,G as Router,N as component,mt as default,H as html,G as router};
//# sourceMappingURL=x-element.min.js.map
