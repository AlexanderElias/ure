/************************************************************************
Name: XElement
Version: 8.0.0
License: MPL-2.0
Author: Alexander Elias
Email: alex.steven.elis@gmail.com
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
************************************************************************/
var k=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var p=(e,t,n)=>(k(e,t,"read from private field"),n?n.call(e):t.get(e)),g=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},N=(e,t,n,i)=>(k(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);var j=(e,t,n)=>(k(e,t,"access private method"),n);var x=(e,t,n)=>new Promise((i,o)=>{var d=r=>{try{h(n.next(r))}catch(m){o(m)}},l=r=>{try{h(n.throw(r))}catch(m){o(m)}},h=r=>r.done?i(r.value):Promise.resolve(r.value).then(d,l);h((n=n.apply(e,t)).next())});function P(e,t){customElements.get(e)||customElements.define(e,t)}function W(e){switch(typeof e){case"undefined":return"";case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e);default:throw new Error("XElement - display type not handled")}}var F=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t!=null&&t.length)for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)},B=function(e,t){return e.indexOf(t)!==-1},Y="trustedTypes"in window?window.trustedTypes.createPolicy("x-element",{createHTML:e=>e}):null,Q=function(e){return Y?Y.createHTML(e):e};var M=Symbol("html"),ee=new WeakMap;function O(e,...t){let n=ee.get(e);if(n)return{strings:e,template:n,expressions:t,symbol:M};{let i="",o=e.length-1;for(let l=0;l<o;l++)i+=`${e[l]}{{${l}}}`;i+=e[o];let d=document.createElement("template");return d.innerHTML=Q(i),ee.set(e,d),{strings:e,template:d,expressions:t,symbol:M}}}var we=NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,te=["src","href","xlink:href"],ge=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ne=function(e){return typeof e!="string"||!ge.test(e)},Ce=function(e,t){var i;let n=t.previousSibling;for(;n!==e;)(i=n==null?void 0:n.parentNode)==null||i.removeChild(n),n=t.previousSibling},oe=function(e,t){var n,i,o,d,l,h,r,m,E,b,c,s;if((t==null?void 0:t.symbol)===M)if(e=e!=null?e:{},t=t!=null?t:{},e.strings===t.strings){let a=this.actions.length;for(let u=0;u<a;u++)this.actions[u](e.expressions[u],t.expressions[u])}else{let a=t.template.content.cloneNode(!0);ie(a,this.actions);let u=this.actions.length;for(let v=0;v<u;v++)this.actions[v]((n=e.expressions)==null?void 0:n[v],t.expressions[v]);document.adoptNode(a),Ce(this.start,this.end),(i=this.end.parentNode)==null||i.insertBefore(a,this.end)}else if((t==null?void 0:t.constructor)===Array){e=e!=null?e:[],t=t!=null?t:[];let a=e.length,u=t.length,v=Math.min(a,u);for(let f=0;f<v;f++)this.actions[f](e[f],t[f]);if(a<u){let f=document.createElement("template");for(let A=a;A<u;A++){let D=document.createTextNode(""),G=document.createTextNode(""),J=oe.bind({start:D,end:G,actions:[]});f.content.appendChild(D),f.content.appendChild(G),this.actions.push(J),J(e[A],t[A])}(o=this.end.parentNode)==null||o.insertBefore(f.content,this.end)}else if(a>u){for(let f=a-1;f>u-1;f--)if(((d=e[f])==null?void 0:d.symbol)===M){let{template:A}=e[f],D=A.content.childNodes.length+2;for(;D--;)(l=this.end.parentNode)==null||l.removeChild(this.end.previousSibling)}else(h=this.end.parentNode)==null||h.removeChild(this.end.previousSibling),(r=this.end.parentNode)==null||r.removeChild(this.end.previousSibling),(m=this.end.parentNode)==null||m.removeChild(this.end.previousSibling);this.actions.length=u}}else{if(e===t)return;for(;this.end.previousSibling!==this.start;)(E=this.end.parentNode)==null||E.removeChild(this.end.previousSibling);let a;this.end.previousSibling===this.start?(a=document.createTextNode(t),(b=this.end.parentNode)==null||b.insertBefore(a,this.end)):this.end.previousSibling.nodeType===Node.TEXT_NODE?(a=this.end.previousSibling,a.textContent=t):(a=document.createTextNode(t),(c=this.end.parentNode)==null||c.removeChild(this.end.previousSibling),(s=this.end.parentNode)==null||s.insertBefore(a,this.end))}},Ne=function(e,t){e!==t&&(this.element.removeAttribute(e),this.name=t==null?void 0:t.toLowerCase(),this.name&&this.element.setAttribute(this.name,""))},Te=function(e,t){if(e!==t)if(this.name==="value")this.value=W(t),Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value);else if(this.name.startsWith("on")){if(typeof e=="function"&&this.element.removeEventListener(this.name.slice(2),e),this.value=t,typeof this.value!="function")return console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);this.element.addEventListener(this.name.slice(2),this.value)}else if(B(te,this.name)){if(this.value=encodeURI(t),ne(this.value)){this.element.removeAttribute(this.name),console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);return}Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else this.value=t,this.name&&(Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value))},ie=function(e,t){var d,l,h,r,m,E,b;let n=document.createTreeWalker(document,we,null);n.currentNode=e;let i=0,o=e.firstChild;for(;(o=n.nextNode())!==null;)if(o.nodeType===Node.TEXT_NODE){let c=(l=(d=o.nodeValue)==null?void 0:d.indexOf("{{"))!=null?l:-1;if(c==-1)continue;c!=0&&(o.splitText(c),o=n.nextNode());let s=(r=(h=o.nodeValue)==null?void 0:h.indexOf("}}"))!=null?r:-1;if(s==-1)continue;s+2!=((m=o.nodeValue)==null?void 0:m.length)&&o.splitText(s+2),i++;let a=document.createTextNode(""),u=o;u.textContent="",(E=u.parentNode)==null||E.insertBefore(a,u),t.push(oe.bind({start:a,end:u,actions:[]}))}else if(o.nodeType===Node.ELEMENT_NODE){(o.nodeName==="SCRIPT"||o.nodeName==="STYLE")&&n.nextSibling();let c=o.getAttributeNames();for(let s of c){let a=(b=o.getAttribute(s))!=null?b:"",u=s.includes("{{")&&s.includes("}}"),v=a.includes("{{")&&a.includes("}}");if(u||v){let f={element:o,name:s,value:a};u&&(i++,o.removeAttribute(s),t.push(Ne.bind(f))),v&&(i++,o.removeAttribute(s),t.push(Te.bind(f)))}else B(te,s)?ne(a)&&(o.removeAttribute(s),console.warn(`XElement - attribute name "${s}" and value "${a}" not allowed`)):s.startsWith("on")&&(o.removeAttribute(s),console.warn(`XElement - attribute name "${s}" not allowed`))}}else console.warn(`XElement - node type "${o.nodeType}" not handled`)},se=ie;var re=function(e,t,n,i,o){if(typeof n=="symbol")return Reflect.set(t,n,i,o);let d=Reflect.get(t,n,o);return d===i||Number.isNaN(d)&&Number.isNaN(i)||(Reflect.set(t,n,i,o),e()),!0},ce=function(e,t,n,i){var d,l,h,r;if(typeof n=="symbol")return Reflect.get(t,n,i);let o=Reflect.get(t,n,i);return((d=o==null?void 0:o.constructor)==null?void 0:d.name)==="Object"||((l=o==null?void 0:o.constructor)==null?void 0:l.name)==="Array"?new Proxy(o,{get:ce.bind(null,e),set:re.bind(null,e),deleteProperty:ae.bind(null,e)}):((h=o==null?void 0:o.constructor)==null?void 0:h.name)==="Function"||((r=o==null?void 0:o.constructor)==null?void 0:r.name)==="AsyncFunction"?new Proxy(o,{apply:(m,E,b)=>Reflect.apply(m,i,b)}):o},ae=function(e,t,n){return typeof n=="symbol"?Reflect.deleteProperty(t,n):(Reflect.deleteProperty(t,n),e(),!0)},Re=function(e,t){return new Proxy(e,{get:ce.bind(null,t),set:re.bind(null,t),deleteProperty:ae.bind(null,t)})},de=Re;function S(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e}var le=new Event("adopted"),he=new Event("adopting"),Be=new Event("upgraded"),Ie=new Event("upgrading"),pe=new Event("creating"),ue=new Event("created"),I=new Event("rendering"),_=new Event("rendered"),me=new Event("connected"),fe=new Event("connecting"),ye=new Event("attributed"),Ee=new Event("attributing"),xe=new Event("disconnected"),be=new Event("disconnecting");var w=Symbol("change"),H,y,$,T,L,R,Ae,X,q,V,ve,C=class extends HTMLElement{constructor(){var o;super();g(this,X);g(this,V);g(this,H,!1);g(this,y,{});g(this,$,void 0);g(this,T,[]);g(this,L,[]);g(this,R,void 0);this[Ae]=void 0;let n=this.constructor;if(n.shadow&&!this.shadowRoot){let d=n.mode||"open";this.attachShadow({mode:d})}N(this,$,(o=this.shadowRoot)!=null?o:this)}static define(n=(i=>(i=this.tag)!=null?i:this.name)()){return n=S(n),P(n,this),this}static create(){return x(this,arguments,function*(n=(i=>(i=this.tag)!=null?i:this.name)()){n=S(n),P(n,this);let o=document.createElement(n);return yield o[w],o})}attributeChangedCallback(n,i,o){return x(this,null,function*(){var d,l;this.dispatchEvent(Ee),yield(l=(d=this.attribute)==null?void 0:d.call(this,n,i,o))==null?void 0:l.catch(console.error),this.dispatchEvent(ye)})}adoptedCallback(){return x(this,null,function*(){var n,i;this.dispatchEvent(he),yield(i=(n=this.adopted)==null?void 0:n.call(this,p(this,y)))==null?void 0:i.catch(console.error),this.dispatchEvent(le)})}connectedCallback(){return x(this,null,function*(){var n,i;p(this,H)||(N(this,H,!0),this[w]=j(this,V,ve).call(this),yield this[w]),this.dispatchEvent(fe),yield(i=(n=this.connected)==null?void 0:n.call(this,p(this,y)))==null?void 0:i.catch(console.error),this.dispatchEvent(me)})}disconnectedCallback(){return x(this,null,function*(){var n,i;this.dispatchEvent(be),yield(i=(n=this.disconnected)==null?void 0:n.call(this,p(this,y)))==null?void 0:i.catch(console.error),this.dispatchEvent(xe)})}};Ae=w,H=new WeakMap,y=new WeakMap,$=new WeakMap,T=new WeakMap,L=new WeakMap,R=new WeakMap,X=new WeakSet,q=function(){return x(this,null,function*(){let n=()=>x(this,null,function*(){var o,d,l;this.dispatchEvent(I);let i=yield(o=this.render)==null?void 0:o.call(this,p(this,y));if(i)for(let h=0;h<p(this,T).length;h++){let r=i.expressions[h],m=p(this,L)[h];p(this,T)[h](m,r),p(this,L)[h]=i.expressions[h]}yield(d=this.rendered)==null?void 0:d.call(this,p(this,y)),this.dispatchEvent(_),this[w]=(l=p(this,R))==null?void 0:l.call(this),N(this,R,void 0),yield this[w]});this[w]?N(this,R,n):this[w]=n()})},V=new WeakSet,ve=function(){return x(this,null,function*(){var h,r,m,E,b;let i=this.constructor.observedProperties,o=Object.getPrototypeOf(this),d=i?i!=null?i:[]:[...Object.getOwnPropertyNames(this),...Object.getOwnPropertyNames(o)];for(let c of d){if(c==="attributeChangedCallback"||c==="disconnectedCallback"||c==="connectedCallback"||c==="adoptedCallback"||c==="constructor"||c==="disconnected"||c==="attribute"||c==="connected"||c==="rendered"||c==="created"||c==="adopted"||c==="render"||c==="setup")continue;let s=(h=Object.getOwnPropertyDescriptor(this,c))!=null?h:Object.getOwnPropertyDescriptor(o,c);s&&s.configurable&&(typeof s.value=="function"&&(s.value=s.value.bind(this)),typeof s.get=="function"&&(s.get=s.get.bind(this)),typeof s.set=="function"&&(s.set=s.set.bind(this)),Object.defineProperty(p(this,y),c,s),Object.defineProperty(this,c,{enumerable:s.enumerable,configurable:!1,get(){return p(this,y)[c]},set(a){p(this,y)[c]=a,j(this,X,q).call(this)}}))}N(this,y,de(p(this,y),j(this,X,q).bind(this))),this.dispatchEvent(I);let l=yield(r=this.render)==null?void 0:r.call(this,p(this,y));if(l){let c=l.template.content.cloneNode(!0);N(this,L,l.expressions),se(c,p(this,T));for(let s=0;s<p(this,T).length;s++){let a=l.expressions[s];p(this,T)[s](void 0,a)}document.adoptNode(c),p(this,$).appendChild(c)}yield(m=this.rendered)==null?void 0:m.call(this,p(this,y)),this.dispatchEvent(_),this[w]=(E=p(this,R))==null?void 0:E.call(this),N(this,R,void 0),yield this[w],this.dispatchEvent(pe),yield(b=this.created)==null?void 0:b.call(this,p(this,y)),this.dispatchEvent(ue)})},C.html=O;var K=[],U=[],z=function(e){return x(this,null,function*(){var t,n;if(e.instance)F(e.root,e.instance);else{let i=yield e.handler();if((i==null?void 0:i.prototype)instanceof HTMLElement)e.construct=i;else if(((t=i==null?void 0:i.default)==null?void 0:t.prototype)instanceof HTMLElement)e.construct=i.default;else throw new Error("XElement - router handler requires a CustomElementConstructor");e.construct.prototype instanceof C?e.instance=yield e.construct.create():(e.tag=S((n=e.construct.tag)!=null?n:e.construct.name),P(e.tag,e.construct),e.instance=document.createElement(e.tag)),F(e.root,e.instance)}})},Pe=function(e){var d,l,h;if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL((d=e==null?void 0:e.destination.url)!=null?d:location.href),n=new URL((h=(l=document.querySelector("base"))==null?void 0:l.href)!=null?h:location.origin);n.hash="",n.search="",t.hash="",t.search="";let i=t.href.replace(n.href,"/"),o=[];for(let r of U)r.path===i&&o.push(r);for(let r of K){let m=!1;for(let E of o)if(E.root===r.root){m=!0;break}m||o.push(r)}if(e!=null&&e.intercept)return e.intercept({handler:()=>o.map(r=>z(r))});if(e!=null&&e.transitionWhile)return e.transitionWhile(o.map(r=>z(r)));o.map(r=>z(r))},Se=function(e,t,n){if(!e)throw new Error("XElement - router path required");if(!n)throw new Error("XElement - router handler required");if(!t)throw new Error("XElement - router root required");if(e==="/*"){for(let i of K)if(i.path===e&&i.root===t)throw new Error("XElement - router duplicate path on root");K.push({path:e,root:t,handler:n})}else{for(let i of U)if(i.path===e&&i.root===t)throw new Error("XElement - router duplicate path on root");U.push({path:e,root:t,handler:n,instance:void 0})}Reflect.get(window,"navigation").addEventListener("navigate",Pe)},Z=Se;var at={Component:C,component:C,Router:Z,router:Z,html:O};export{C as Component,Z as Router,C as component,at as default,O as html,Z as router};
//# sourceMappingURL=x-element.min.js.map
