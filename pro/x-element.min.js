/************************************************************************
Name: XElement
Version: 8.2.0
License: MPL-2.0
Author: Alexander Elias
Email: alex.steven.elis@gmail.com
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
************************************************************************/
var q=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var u=(e,t,n)=>(q(e,t,"read from private field"),n?n.call(e):t.get(e)),w=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},v=(e,t,n,o)=>(q(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var Q=(e,t,n)=>(q(e,t,"access private method"),n);var x=(e,t,n)=>new Promise((o,s)=>{var i=c=>{try{l(n.next(c))}catch(r){s(r)}},a=c=>{try{l(n.throw(c))}catch(r){s(r)}},l=c=>c.done?o(c.value):Promise.resolve(c.value).then(i,a);l((n=n.apply(e,t)).next())});function S(e,t){customElements.get(e)||customElements.define(e,t)}function L(e){switch(`${e}`){case"NaN":return"";case"null":return"";case"undefined":return""}switch(typeof e){case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e)}throw new Error("XElement - display type not handled")}var ee=()=>Math.floor(Math.random()*Date.now());var _=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t!=null&&t.length)for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)},I=function(e,t){return e.indexOf(t)!==-1},te="trustedTypes"in window?window.trustedTypes.createPolicy("x-element",{createHTML:e=>e}):null,ne=function(e){return te?te.createHTML(e):e};var H=Symbol("html"),oe=new WeakMap;function X(e,...t){let n=oe.get(e);if(n){let[o,s]=n;return{strings:e,template:o,expressions:t,symbol:H,marker:s}}else{let o=`X-${ee()}-X`,s="",i=e.length-1;for(let l=0;l<i;l++)s+=`${e[l]}${o}`;s+=e[i];let a=document.createElement("template");return a.innerHTML=ne(s),oe.set(e,[a,o]),{strings:e,template:a,expressions:t,symbol:H,marker:o}}}var Ne=NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,ie=["src","href","xlink:href"],Te=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,se=function(e){return e===""||typeof e!="string"?!1:!Te.test(e)},Re=function(e,t){var o;let n=t.previousSibling;for(;n!==e;)(o=n==null?void 0:n.parentNode)==null||o.removeChild(n),n=t.previousSibling},re=function(e,t){var n,o,s,i,a,l,c,r,d,g,E,R,p;if((t==null?void 0:t.symbol)===H)if(e=e!=null?e:{},t=t!=null?t:{},e.strings===t.strings){let h=this.actions.length;for(let m=0;m<h;m++)this.actions[m](e.expressions[m],t.expressions[m])}else{this.actions.length=0;let h=t.template.content.cloneNode(!0);ae(h,this.actions,t.marker);let m=this.actions.length;for(let b=0;b<m;b++)this.actions[b]((n=e.expressions)==null?void 0:n[b],t.expressions[b]);document.adoptNode(h),Re(this.start,this.end),(o=this.end.parentNode)==null||o.insertBefore(h,this.end)}else if((t==null?void 0:t.constructor)===Array){e=e!=null?e:[],t=t!=null?t:[];let h=e.length,m=t.length,b=Math.min(h,m);for(let f=0;f<b;f++)this.actions[f](e[f],t[f]);if(h<m){let f=document.createElement("template");for(let M=h;M<m;M++){let j=document.createTextNode(""),J=document.createTextNode(""),Y=re.bind({start:j,end:J,actions:[]});f.content.appendChild(j),f.content.appendChild(J),this.actions.push(Y),Y(e[M],t[M])}(s=this.end.parentNode)==null||s.insertBefore(f.content,this.end)}else if(h>m){for(let f=h-1;f>m-1;f--)if(((i=e[f])==null?void 0:i.symbol)===H){let{template:M}=e[f],j=M.content.childNodes.length+2;for(;j--;)(a=this.end.parentNode)==null||a.removeChild(this.end.previousSibling)}else(l=this.end.parentNode)==null||l.removeChild(this.end.previousSibling),(c=this.end.parentNode)==null||c.removeChild(this.end.previousSibling),(r=this.end.parentNode)==null||r.removeChild(this.end.previousSibling);this.actions.length=m}}else{if(e===t)return;if(typeof e!=typeof t)for(;this.end.previousSibling!==this.start;)(d=this.end.parentNode)==null||d.removeChild(this.end.previousSibling);let h;this.end.previousSibling===this.start?(h=document.createTextNode(L(t)),(g=this.end.parentNode)==null||g.insertBefore(h,this.end)):((E=this.end.previousSibling)==null?void 0:E.nodeType)===Node.TEXT_NODE?(h=this.end.previousSibling,h.textContent=L(t)):(h=document.createTextNode(L(t)),(R=this.end.parentNode)==null||R.removeChild(this.end.previousSibling),(p=this.end.parentNode)==null||p.insertBefore(h,this.end))}},Ae=function(e,t){e!==t&&(e!=null&&e.startsWith("on")&&typeof this.value=="function"&&this.element.removeEventListener(e.slice(2),this.value),Reflect.set(this.element,e,void 0),this.element.removeAttribute(e),this.name=t==null?void 0:t.toLowerCase(),this.name&&this.element.setAttribute(this.name,""))},Me=function(e,t){if(e!==t)if(this.name==="value"){if(this.value=L(t),!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else if(this.name.startsWith("on")){if(!this.name)return;if(typeof this.value=="function"&&this.element.removeEventListener(this.name.slice(2),this.value,!0),this.value=t,typeof this.value!="function")return console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);this.element.addEventListener(this.name.slice(2),this.value,!0)}else if(I(ie,this.name)){if(this.value=encodeURI(t),!this.name)return;if(se(this.value)){this.element.removeAttribute(this.name),console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);return}Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else{if(this.value=t,!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}},Se=function(e,t){var o,s,i,a;if(e===t)return;let n=this.element;if(t){(o=n.parentNode)==null||o.removeChild(n);let l=document.createElement(t);for(;n.firstChild;)l.appendChild(n.firstChild);if(n.nodeType===Node.ELEMENT_NODE){let c=n.getAttributeNames();for(let r of c){let d=(s=n.getAttribute(r))!=null?s:"";l.setAttribute(r,d)}}(i=this.holder.parentNode)==null||i.insertBefore(l,this.holder),this.element=l}else(a=n.parentNode)==null||a.removeChild(n),this.element=n},ae=function(e,t,n){var a,l,c,r,d,g;let o=new WeakSet,s=document.createTreeWalker(document,Ne,null);s.currentNode=e;let i=e.firstChild;for(;i=s.nextNode();)if(o.has(i.previousSibling)&&(o.delete(i.previousSibling),t.push(()=>{})),i.nodeType===Node.TEXT_NODE){let E=(l=(a=i.nodeValue)==null?void 0:a.indexOf(n))!=null?l:-1;if(E===-1)continue;E!==0&&(i.splitText(E),i=s.nextNode());let R=n.length;R!==((c=i.nodeValue)==null?void 0:c.length)&&i.splitText(R);let p=document.createTextNode(""),h=i;h.textContent="",(r=h.parentNode)==null||r.insertBefore(p,h),t.push(re.bind({marker:n,start:p,end:h,actions:[]}))}else if(i.nodeType===Node.ELEMENT_NODE){(i.nodeName==="SCRIPT"||i.nodeName==="STYLE")&&s.nextSibling();let E={element:i};i.nodeName===n&&(o.add(i),E.holder=document.createTextNode(""),(d=i.parentNode)==null||d.insertBefore(E.holder,i),t.push(Se.bind(E)));let R=i.getAttributeNames();for(let p of R){let h=(g=i.getAttribute(p))!=null?g:"",m=p.toUpperCase().includes(n),b=h.includes(n);if(m||b){let f={name:p,value:h,previous:void 0,get element(){return E.element}};m&&(i.removeAttribute(p),t.push(Ae.bind(f))),b&&(i.removeAttribute(p),t.push(Me.bind(f)))}else I(ie,p)?se(h)&&(i.removeAttribute(p),console.warn(`XElement - attribute name "${p}" and value "${h}" not allowed`)):p.startsWith("on")&&(i.removeAttribute(p),console.warn(`XElement - attribute name "${p}" not allowed`))}}else console.warn(`XElement - node type "${i.nodeType}" not handled`)},ce=ae;var le=function(e,t,n,o,s){if(typeof n=="symbol")return Reflect.set(t,n,o,s);let i=Reflect.get(t,n,s);return i===o||Number.isNaN(i)&&Number.isNaN(o)||(Reflect.set(t,n,o,s),e()),!0},de=function(e,t,n,o){if(typeof n=="symbol")return Reflect.get(t,n,o);let s=Reflect.get(t,n,o);return s&&typeof s=="function"?new Proxy(s,{apply(i,a,l){return Reflect.apply(i,t,l)}}):s&&typeof s=="object"?new Proxy(s,{get:de.bind(null,e),set:le.bind(null,e),deleteProperty:he.bind(null,e)}):s},he=function(e,t,n){return typeof n=="symbol"?Reflect.deleteProperty(t,n):(Reflect.deleteProperty(t,n),e(),!0)},Le=function(e,t){return new Proxy(e,{get:de.bind(null,t),set:le.bind(null,t),deleteProperty:he.bind(null,t)})},ue=Le;function P(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e}var pe=new Event("adopted"),me=new Event("adopting"),Ue=new Event("upgraded"),Ze=new Event("upgrading"),fe=new Event("creating"),ye=new Event("created"),Ee=new Event("rendering"),ve=new Event("rendered"),F=new Event("connected"),z=new Event("connecting"),xe=new Event("attributed"),be=new Event("attributing"),we=new Event("disconnected"),ge=new Event("disconnecting");var O=Symbol("ChangeTask"),V=Symbol("ChangeRequest"),D,y,k,W,N,$,T,A,Pe,B,Ce,C=class extends HTMLElement{constructor(){var s;super();w(this,B);w(this,D,!1);w(this,y,{});w(this,k,void 0);w(this,W,"");w(this,N,[]);w(this,$,[]);w(this,T,!1);w(this,A,!1);this[Pe]=Promise.resolve();let n=this.constructor;if(n.shadow&&!this.shadowRoot){let i=n.mode||"open";this.attachShadow({mode:i})}v(this,k,(s=this.shadowRoot)!=null?s:this)}static define(n=(o=>(o=this.tag)!=null?o:this.name)()){return n=P(n),S(n,this),this}static create(){return x(this,arguments,function*(n=(o=>(o=this.tag)!=null?o:this.name)()){n=P(n),S(n,this);let s=document.createElement(n);return yield s[O],s})}attributeChangedCallback(n,o,s){return x(this,null,function*(){var i,a;this.dispatchEvent(be),yield(a=(i=this.attribute)==null?void 0:i.call(this,n,o,s))==null?void 0:a.catch(console.error),this.dispatchEvent(xe)})}adoptedCallback(){return x(this,null,function*(){var n,o;this.dispatchEvent(me),yield(o=(n=this.adopted)==null?void 0:n.call(this,u(this,y)))==null?void 0:o.catch(console.error),this.dispatchEvent(pe)})}connectedCallback(){return x(this,null,function*(){var n,o,s,i,a;u(this,D)?(this.dispatchEvent(z),yield(a=(i=this.connected)==null?void 0:i.call(this,u(this,y)))==null?void 0:a.catch(console.error),this.dispatchEvent(F)):(v(this,D,!0),v(this,T,!0),yield Q(this,B,Ce).call(this),this.dispatchEvent(fe),yield(n=this.created)==null?void 0:n.call(this,u(this,y)),this.dispatchEvent(ye),this.dispatchEvent(z),yield(s=(o=this.connected)==null?void 0:o.call(this,u(this,y)))==null?void 0:s.catch(console.error),this.dispatchEvent(F),v(this,T,!1),v(this,A,!1),yield this[V]())})}disconnectedCallback(){return x(this,null,function*(){var n,o;this.dispatchEvent(ge),yield(o=(n=this.disconnected)==null?void 0:n.call(this,u(this,y)))==null?void 0:o.catch(console.error),this.dispatchEvent(we)})}[(Pe=O,V)](){return x(this,null,function*(){return u(this,T)?(v(this,A,!0),this[O]):(v(this,T,!0),this[O]=this[O].then(()=>x(this,null,function*(){var o,s;this.dispatchEvent(Ee);let n=yield(o=this.render)==null?void 0:o.call(this,u(this,y));if(n)for(let i=0;i<u(this,N).length;i++){if(u(this,A)){yield Promise.resolve().then().catch(console.error),i=-1,v(this,A,!1);continue}let a=n.expressions[i],l=u(this,$)[i];try{u(this,N)[i](l,a)}catch(c){console.error(c)}u(this,$)[i]=n.expressions[i]}v(this,T,!1),yield(s=this.rendered)==null?void 0:s.call(this,u(this,y)),this.dispatchEvent(ve)})).catch(console.error),this[O])})}};D=new WeakMap,y=new WeakMap,k=new WeakMap,W=new WeakMap,N=new WeakMap,$=new WeakMap,T=new WeakMap,A=new WeakMap,B=new WeakSet,Ce=function(){return x(this,null,function*(){var l,c;let o=this.constructor.observedProperties,s=Object.getPrototypeOf(this),i=o?o!=null?o:[]:[...Object.getOwnPropertyNames(this),...Object.getOwnPropertyNames(s)];for(let r of i){if(r==="attributeChangedCallback"||r==="disconnectedCallback"||r==="connectedCallback"||r==="adoptedCallback"||r==="constructor"||r==="disconnected"||r==="attribute"||r==="connected"||r==="rendered"||r==="created"||r==="adopted"||r==="render"||r==="setup")continue;let d=(l=Object.getOwnPropertyDescriptor(this,r))!=null?l:Object.getOwnPropertyDescriptor(s,r);d&&d.configurable&&(typeof d.value=="function"&&(d.value=d.value.bind(this)),typeof d.get=="function"&&(d.get=d.get.bind(this)),typeof d.set=="function"&&(d.set=d.set.bind(this)),Object.defineProperty(u(this,y),r,d),Object.defineProperty(this,r,{enumerable:d.enumerable,configurable:!1,get(){return u(this,y)[r]},set(g){u(this,y)[r]=g,this[V]()}}))}v(this,y,ue(u(this,y),this[V].bind(this)));let a=yield(c=this.render)==null?void 0:c.call(this,u(this,y));if(a){let r=a.template.content.cloneNode(!0);v(this,W,a.marker),v(this,$,a.expressions),ce(r,u(this,N),u(this,W));for(let d=0;d<u(this,N).length;d++){let g=a.expressions[d];try{u(this,N)[d](void 0,g)}catch(E){console.error(E)}}document.adoptNode(r),u(this,k).appendChild(r)}})},C.html=X;var U=[],Z=[],K=function(e){return x(this,null,function*(){var t,n;if(e.instance)_(e.root,e.instance);else{let o=yield e.handler();if((o==null?void 0:o.prototype)instanceof HTMLElement)e.construct=o;else if(((t=o==null?void 0:o.default)==null?void 0:t.prototype)instanceof HTMLElement)e.construct=o.default;else throw new Error("XElement - router handler requires a CustomElementConstructor");e.construct.prototype instanceof C?e.instance=yield e.construct.create():(e.tag=P((n=e.construct.tag)!=null?n:e.construct.name),S(e.tag,e.construct),e.instance=document.createElement(e.tag)),_(e.root,e.instance)}})},Oe=function(e){var i,a,l;if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL((i=e==null?void 0:e.destination.url)!=null?i:location.href),n=new URL((l=(a=document.querySelector("base"))==null?void 0:a.href)!=null?l:location.origin);n.hash="",n.search="",t.hash="",t.search="";let o=t.href.replace(n.href,"/"),s=[];for(let c of Z)c.path===o&&s.push(c);for(let c of U){let r=!1;for(let d of s)if(d.root===c.root){r=!0;break}r||s.push(c)}if(e!=null&&e.intercept)return e.intercept({handler:()=>s.map(c=>K(c))});if(e!=null&&e.transitionWhile)return e.transitionWhile(s.map(c=>K(c)));s.map(c=>K(c))},$e=function(e,t,n){if(!e)throw new Error("XElement - router path required");if(!n)throw new Error("XElement - router handler required");if(!t)throw new Error("XElement - router root required");if(e==="/*"){for(let o of U)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");U.push({path:e,root:t,handler:n})}else{for(let o of Z)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");Z.push({path:e,root:t,handler:n,instance:void 0})}Reflect.get(window,"navigation").addEventListener("navigate",Oe)},G=$e;var mt={Component:C,component:C,Router:G,router:G,html:X};export{C as Component,G as Router,C as component,mt as default,X as html,G as router};
//# sourceMappingURL=x-element.min.js.map
