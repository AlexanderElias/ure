/************************************************************************
Name: XElement
Version: 8.2.2
License: MPL-2.0
Author: Alexander Elias
Email: alex.steven.elis@gmail.com
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
************************************************************************/
var Y=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var u=(e,t,n)=>(Y(e,t,"read from private field"),n?n.call(e):t.get(e)),C=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},v=(e,t,n,o)=>(Y(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var x=(e,t,n)=>new Promise((o,s)=>{var i=a=>{try{l(n.next(a))}catch(r){s(r)}},c=a=>{try{l(n.throw(a))}catch(r){s(r)}},l=a=>a.done?o(a.value):Promise.resolve(a.value).then(i,c);l((n=n.apply(e,t)).next())});function M(e,t){customElements.get(e)||customElements.define(e,t)}function L(e){switch(`${e}`){case"NaN":return"";case"null":return"";case"undefined":return""}switch(typeof e){case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e)}throw new Error("XElement - display type not handled")}var Q=()=>Math.floor(Math.random()*Date.now());var B=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t!=null&&t.length)for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)},_=function(e,t){return e.indexOf(t)!==-1},ee="trustedTypes"in window?window.trustedTypes.createPolicy("x-element",{createHTML:e=>e}):null,te=function(e){return ee?ee.createHTML(e):e};var $=Symbol("html"),ne=new WeakMap;function H(e,...t){let n=ne.get(e);if(n){let[o,s]=n;return{strings:e,template:o,expressions:t,symbol:$,marker:s}}else{let o=`X-${Q()}-X`,s="",i=e.length-1;for(let l=0;l<i;l++)s+=`${e[l]}${o}`;s+=e[i];let c=document.createElement("template");return c.innerHTML=te(s),ne.set(e,[c,o]),{strings:e,template:c,expressions:t,symbol:$,marker:o}}}var ge=NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,oe=["src","href","xlink:href"],Ne=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ie=function(e){return e===""||typeof e!="string"?!1:!Ne.test(e)},Te=function(e,t){var o;let n=t.previousSibling;for(;n!==e;)(o=n==null?void 0:n.parentNode)==null||o.removeChild(n),n=t.previousSibling},se=function(e,t){var n,o,s,i,c,l,a,r,d,w,E,R,p;if((t==null?void 0:t.symbol)===$)if(e=e!=null?e:{},t=t!=null?t:{},e.strings===t.strings){let h=this.actions.length;for(let m=0;m<h;m++)this.actions[m](e.expressions[m],t.expressions[m])}else{this.actions.length=0;let h=t.template.content.cloneNode(!0);re(h,this.actions,t.marker);let m=this.actions.length;for(let b=0;b<m;b++)this.actions[b]((n=e.expressions)==null?void 0:n[b],t.expressions[b]);document.adoptNode(h),Te(this.start,this.end),(o=this.end.parentNode)==null||o.insertBefore(h,this.end)}else if((t==null?void 0:t.constructor)===Array){e=e!=null?e:[],t=t!=null?t:[];let h=e.length,m=t.length,b=Math.min(h,m);for(let f=0;f<b;f++)this.actions[f](e[f],t[f]);if(h<m){let f=document.createElement("template");for(let S=h;S<m;S++){let j=document.createTextNode(""),G=document.createTextNode(""),J=se.bind({start:j,end:G,actions:[]});f.content.appendChild(j),f.content.appendChild(G),this.actions.push(J),J(e[S],t[S])}(s=this.end.parentNode)==null||s.insertBefore(f.content,this.end)}else if(h>m){for(let f=h-1;f>m-1;f--)if(((i=e[f])==null?void 0:i.symbol)===$){let{template:S}=e[f],j=S.content.childNodes.length+2;for(;j--;)(c=this.end.parentNode)==null||c.removeChild(this.end.previousSibling)}else(l=this.end.parentNode)==null||l.removeChild(this.end.previousSibling),(a=this.end.parentNode)==null||a.removeChild(this.end.previousSibling),(r=this.end.parentNode)==null||r.removeChild(this.end.previousSibling);this.actions.length=m}}else{if(e===t)return;if(typeof e!=typeof t)for(;this.end.previousSibling!==this.start;)(d=this.end.parentNode)==null||d.removeChild(this.end.previousSibling);let h;this.end.previousSibling===this.start?(h=document.createTextNode(L(t)),(w=this.end.parentNode)==null||w.insertBefore(h,this.end)):((E=this.end.previousSibling)==null?void 0:E.nodeType)===Node.TEXT_NODE?(h=this.end.previousSibling,h.textContent=L(t)):(h=document.createTextNode(L(t)),(R=this.end.parentNode)==null||R.removeChild(this.end.previousSibling),(p=this.end.parentNode)==null||p.insertBefore(h,this.end))}},Re=function(e,t){e!==t&&(e!=null&&e.startsWith("on")&&typeof this.value=="function"&&this.element.removeEventListener(e.slice(2),this.value),Reflect.set(this.element,e,void 0),this.element.removeAttribute(e),this.name=t==null?void 0:t.toLowerCase(),this.name&&this.element.setAttribute(this.name,""))},Ae=function(e,t){if(e!==t)if(this.name==="value"){if(this.value=L(t),!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else if(this.name.startsWith("on")){if(!this.name)return;if(typeof this.value=="function"&&this.element.removeEventListener(this.name.slice(2),this.value,!0),this.value=t,typeof this.value!="function")return console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);this.element.addEventListener(this.name.slice(2),this.value,!0)}else if(_(oe,this.name)){if(this.value=encodeURI(t),!this.name)return;if(ie(this.value)){this.element.removeAttribute(this.name),console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);return}Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else{if(this.value=t,!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}},Se=function(e,t){var o,s,i,c;if(e===t)return;let n=this.element;if(t){(o=n.parentNode)==null||o.removeChild(n);let l=document.createElement(t);for(;n.firstChild;)l.appendChild(n.firstChild);if(n.nodeType===Node.ELEMENT_NODE){let a=n.getAttributeNames();for(let r of a){let d=(s=n.getAttribute(r))!=null?s:"";l.setAttribute(r,d)}}(i=this.holder.parentNode)==null||i.insertBefore(l,this.holder),this.element=l}else(c=n.parentNode)==null||c.removeChild(n),this.element=n},re=function(e,t,n){var c,l,a,r,d,w;let o=new WeakSet,s=document.createTreeWalker(document,ge,null);s.currentNode=e;let i=e.firstChild;for(;i=s.nextNode();)if(o.has(i.previousSibling)&&(o.delete(i.previousSibling),t.push(()=>{})),i.nodeType===Node.TEXT_NODE){let E=(l=(c=i.nodeValue)==null?void 0:c.indexOf(n))!=null?l:-1;if(E===-1)continue;E!==0&&(i.splitText(E),i=s.nextNode());let R=n.length;R!==((a=i.nodeValue)==null?void 0:a.length)&&i.splitText(R);let p=document.createTextNode(""),h=i;h.textContent="",(r=h.parentNode)==null||r.insertBefore(p,h),t.push(se.bind({marker:n,start:p,end:h,actions:[]}))}else if(i.nodeType===Node.ELEMENT_NODE){(i.nodeName==="SCRIPT"||i.nodeName==="STYLE")&&s.nextSibling();let E={element:i};i.nodeName===n&&(o.add(i),E.holder=document.createTextNode(""),(d=i.parentNode)==null||d.insertBefore(E.holder,i),t.push(Se.bind(E)));let R=i.getAttributeNames();for(let p of R){let h=(w=i.getAttribute(p))!=null?w:"",m=p.toUpperCase().includes(n),b=h.includes(n);if(m||b){let f={name:p,value:h,previous:void 0,get element(){return E.element}};m&&(i.removeAttribute(p),t.push(Re.bind(f))),b&&(i.removeAttribute(p),t.push(Ae.bind(f)))}else _(oe,p)?ie(h)&&(i.removeAttribute(p),console.warn(`XElement - attribute name "${p}" and value "${h}" not allowed`)):p.startsWith("on")&&(i.removeAttribute(p),console.warn(`XElement - attribute name "${p}" not allowed`))}}else console.warn(`XElement - node type "${i.nodeType}" not handled`)},ae=re;var ce=function(e,t,n,o,s){if(typeof n=="symbol")return Reflect.set(t,n,o,s);let i=Reflect.get(t,n,s);return i===o||Number.isNaN(i)&&Number.isNaN(o)||(Reflect.set(t,n,o,s),e()),!0},le=function(e,t,n,o){if(typeof n=="symbol")return Reflect.get(t,n,o);let s=Reflect.get(t,n,o);return s&&typeof s=="function"?new Proxy(s,{apply(i,c,l){return Reflect.apply(i.bind(t),o,l)}}):s&&typeof s=="object"?new Proxy(s,{get:le.bind(null,e),set:ce.bind(null,e),deleteProperty:de.bind(null,e)}):s},de=function(e,t,n){return typeof n=="symbol"?Reflect.deleteProperty(t,n):(Reflect.deleteProperty(t,n),e(),!0)},Me=function(e,t){return new Proxy(e,{get:le.bind(null,t),set:ce.bind(null,t),deleteProperty:de.bind(null,t)})},he=Me;function P(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e}var ue=new Event("adopted"),pe=new Event("adopting"),ze=new Event("upgraded"),Ke=new Event("upgrading"),me=new Event("creating"),fe=new Event("created"),ye=new Event("rendering"),Ee=new Event("rendered"),I=new Event("connected"),q=new Event("connecting"),ve=new Event("attributed"),xe=new Event("attributing"),be=new Event("disconnected"),we=new Event("disconnecting");var X=Symbol("Task"),F=Symbol("Create"),Ce=Symbol("Setup"),V=Symbol("Update"),y,D,k,N,O,T,A,W,Le,g=class extends HTMLElement{constructor(){var s;super();C(this,y,{});C(this,D,void 0);C(this,k,"");C(this,N,[]);C(this,O,[]);C(this,T,!1);C(this,A,!1);C(this,W,!1);this[Le]=Promise.resolve();let n=this.constructor;if(n.shadow&&!this.shadowRoot){let i=n.mode||"open";this.attachShadow({mode:i})}v(this,D,(s=this.shadowRoot)!=null?s:this)}static define(n=(o=>(o=this.tag)!=null?o:this.name)()){return n=P(n),M(n,this),this}static create(){return x(this,arguments,function*(n=(o=>(o=this.tag)!=null?o:this.name)()){n=P(n),M(n,this);let s=document.createElement(n);return yield s[F],s})}attributeChangedCallback(n,o,s){return x(this,null,function*(){var i,c;this.dispatchEvent(xe),yield(c=(i=this.attribute)==null?void 0:i.call(this,n,o,s))==null?void 0:c.catch(console.error),this.dispatchEvent(ve)})}adoptedCallback(){return x(this,null,function*(){var n,o;this.dispatchEvent(pe),yield(o=(n=this.adopted)==null?void 0:n.call(this,u(this,y)))==null?void 0:o.catch(console.error),this.dispatchEvent(ue)})}connectedCallback(){return x(this,null,function*(){var n,o;u(this,W)?(this.dispatchEvent(q),yield(o=(n=this.connected)==null?void 0:n.call(this,u(this,y)))==null?void 0:o.catch(console.error),this.dispatchEvent(I)):yield this[F]()})}disconnectedCallback(){return x(this,null,function*(){var n,o;this.dispatchEvent(we),yield(o=(n=this.disconnected)==null?void 0:n.call(this,u(this,y)))==null?void 0:o.catch(console.error),this.dispatchEvent(be)})}[(Le=X,F)](){return x(this,null,function*(){var n,o,s;v(this,W,!0),v(this,T,!0),yield this[Ce](),this.dispatchEvent(me),yield(n=this.created)==null?void 0:n.call(this,u(this,y)),this.dispatchEvent(fe),this.dispatchEvent(q),yield(s=(o=this.connected)==null?void 0:o.call(this,u(this,y)))==null?void 0:s.catch(console.error),this.dispatchEvent(I),v(this,T,!1),v(this,A,!1),yield this[V]()})}[V](){return x(this,null,function*(){return u(this,T)?(v(this,A,!0),this[X]):(v(this,T,!0),this[X]=this[X].then(()=>x(this,null,function*(){var o,s;this.dispatchEvent(ye);let n=yield(o=this.render)==null?void 0:o.call(this,u(this,y));if(n)for(let i=0;i<u(this,N).length;i++){if(u(this,A)){yield Promise.resolve().then().catch(console.error),i=-1,v(this,A,!1);continue}let c=n.expressions[i],l=u(this,O)[i];try{u(this,N)[i](l,c)}catch(a){console.error(a)}u(this,O)[i]=n.expressions[i]}v(this,T,!1),yield(s=this.rendered)==null?void 0:s.call(this,u(this,y)),this.dispatchEvent(Ee)})).catch(console.error),this[X])})}[Ce](){return x(this,null,function*(){var l,a;let o=this.constructor.observedProperties,s=Object.getPrototypeOf(this),i=o?o!=null?o:[]:[...Object.getOwnPropertyNames(this),...Object.getOwnPropertyNames(s)];for(let r of i){if(r==="attributeChangedCallback"||r==="disconnectedCallback"||r==="connectedCallback"||r==="adoptedCallback"||r==="constructor"||r==="disconnected"||r==="attribute"||r==="connected"||r==="rendered"||r==="created"||r==="adopted"||r==="render"||r==="setup")continue;let d=(l=Object.getOwnPropertyDescriptor(this,r))!=null?l:Object.getOwnPropertyDescriptor(s,r);d&&d.configurable&&(typeof d.value=="function"&&(d.value=d.value.bind(this)),typeof d.get=="function"&&(d.get=d.get.bind(this)),typeof d.set=="function"&&(d.set=d.set.bind(this)),Object.defineProperty(u(this,y),r,d),Object.defineProperty(this,r,{enumerable:d.enumerable,configurable:!1,get(){return u(this,y)[r]},set(w){u(this,y)[r]=w,this[V]()}}))}v(this,y,he(u(this,y),this[V].bind(this)));let c=yield(a=this.render)==null?void 0:a.call(this,u(this,y));if(c){let r=c.template.content.cloneNode(!0);v(this,k,c.marker),v(this,O,c.expressions),ae(r,u(this,N),u(this,k));for(let d=0;d<u(this,N).length;d++){let w=c.expressions[d];try{u(this,N)[d](void 0,w)}catch(E){console.error(E)}}document.adoptNode(r),u(this,D).appendChild(r)}})}};y=new WeakMap,D=new WeakMap,k=new WeakMap,N=new WeakMap,O=new WeakMap,T=new WeakMap,A=new WeakMap,W=new WeakMap,g.html=H;var z=[],K=[],U=function(e){return x(this,null,function*(){var t,n;if(e.instance)B(e.root,e.instance);else{let o=yield e.handler();if((o==null?void 0:o.prototype)instanceof HTMLElement)e.construct=o;else if(((t=o==null?void 0:o.default)==null?void 0:t.prototype)instanceof HTMLElement)e.construct=o.default;else throw new Error("XElement - router handler requires a CustomElementConstructor");e.construct.prototype instanceof g?e.instance=yield e.construct.create():(e.tag=P((n=e.construct.tag)!=null?n:e.construct.name),M(e.tag,e.construct),e.instance=document.createElement(e.tag)),B(e.root,e.instance)}})},Pe=function(e){var i,c,l;if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL((i=e==null?void 0:e.destination.url)!=null?i:location.href),n=new URL((l=(c=document.querySelector("base"))==null?void 0:c.href)!=null?l:location.origin);n.hash="",n.search="",t.hash="",t.search="";let o=t.href.replace(n.href,"/"),s=[];for(let a of K)a.path===o&&s.push(a);for(let a of z){let r=!1;for(let d of s)if(d.root===a.root){r=!0;break}r||s.push(a)}if(e!=null&&e.intercept)return e.intercept({handler:()=>s.map(a=>U(a))});if(e!=null&&e.transitionWhile)return e.transitionWhile(s.map(a=>U(a)));s.map(a=>U(a))},Oe=function(e,t,n){if(!e)throw new Error("XElement - router path required");if(!n)throw new Error("XElement - router handler required");if(!t)throw new Error("XElement - router root required");if(e==="/*"){for(let o of z)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");z.push({path:e,root:t,handler:n})}else{for(let o of K)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");K.push({path:e,root:t,handler:n,instance:void 0})}Reflect.get(window,"navigation").addEventListener("navigate",Pe)},Z=Oe;var pt={Component:g,component:g,Router:Z,router:Z,html:H};export{g as Component,Z as Router,g as component,pt as default,H as html,Z as router};
//# sourceMappingURL=x-element.min.js.map
