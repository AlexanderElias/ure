/************************************************************************
Name: XElement
Version: 8.0.0
License: MPL-2.0
Author: Alexander Elias
Email: alex.steven.elis@gmail.com
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
************************************************************************/
var W=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var u=(e,t,n)=>(W(e,t,"read from private field"),n?n.call(e):t.get(e)),w=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},C=(e,t,n,o)=>(W(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var j=(e,t,n)=>(W(e,t,"access private method"),n);var v=(e,t,n)=>new Promise((o,i)=>{var s=a=>{try{c(n.next(a))}catch(m){i(m)}},l=a=>{try{c(n.throw(a))}catch(m){i(m)}},c=a=>a.done?o(a.value):Promise.resolve(a.value).then(s,l);c((n=n.apply(e,t)).next())});function M(e,t){customElements.get(e)||customElements.define(e,t)}function F(e){switch(typeof e){case"undefined":return"";case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e);default:throw new Error("XElement - display type not handled")}}var Q=()=>Math.floor(Math.random()*Date.now());var B=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t!=null&&t.length)for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)},I=function(e,t){return e.indexOf(t)!==-1},ee="trustedTypes"in window?window.trustedTypes.createPolicy("x-element",{createHTML:e=>e}):null,te=function(e){return ee?ee.createHTML(e):e};var P=Symbol("html"),ne=new WeakMap;function O(e,...t){let n=ne.get(e);if(n){let[o,i]=n;return{strings:e,template:o,expressions:t,symbol:P,marker:i}}else{let o=`X-${Q()}-X`,i="",s=e.length-1;for(let c=0;c<s;c++)i+=`${e[c]}${o}`;i+=e[s];let l=document.createElement("template");return l.innerHTML=te(i),ne.set(e,[l,o]),{strings:e,template:l,expressions:t,symbol:P,marker:o}}}var Ce=NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,oe=["src","href","xlink:href"],Ne=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ie=function(e){return e===""||typeof e!="string"?!1:!Ne.test(e)},Te=function(e,t){var o;let n=t.previousSibling;for(;n!==e;)(o=n==null?void 0:n.parentNode)==null||o.removeChild(n),n=t.previousSibling},se=function(e,t){var n,o,i,s,l,c,a,m,x,E,h,r;if((t==null?void 0:t.symbol)===P)if(e=e!=null?e:{},t=t!=null?t:{},e.strings===t.strings){let d=this.actions.length;for(let p=0;p<d;p++)this.actions[p](e.expressions[p],t.expressions[p])}else{let d=t.template.content.cloneNode(!0);re(d,this.actions,t.marker);let p=this.actions.length;for(let b=0;b<p;b++)this.actions[b]((n=e.expressions)==null?void 0:n[b],t.expressions[b]);document.adoptNode(d),Te(this.start,this.end),(o=this.end.parentNode)==null||o.insertBefore(d,this.end)}else if((t==null?void 0:t.constructor)===Array){e=e!=null?e:[],t=t!=null?t:[];let d=e.length,p=t.length,b=Math.min(d,p);for(let f=0;f<b;f++)this.actions[f](e[f],t[f]);if(d<p){let f=document.createElement("template");for(let A=d;A<p;A++){let k=document.createTextNode(""),J=document.createTextNode(""),Y=se.bind({start:k,end:J,actions:[]});f.content.appendChild(k),f.content.appendChild(J),this.actions.push(Y),Y(e[A],t[A])}(i=this.end.parentNode)==null||i.insertBefore(f.content,this.end)}else if(d>p){for(let f=d-1;f>p-1;f--)if(((s=e[f])==null?void 0:s.symbol)===P){let{template:A}=e[f],k=A.content.childNodes.length+2;for(;k--;)(l=this.end.parentNode)==null||l.removeChild(this.end.previousSibling)}else(c=this.end.parentNode)==null||c.removeChild(this.end.previousSibling),(a=this.end.parentNode)==null||a.removeChild(this.end.previousSibling),(m=this.end.parentNode)==null||m.removeChild(this.end.previousSibling);this.actions.length=p}}else{if(e===t)return;for(;this.end.previousSibling!==this.start;)(x=this.end.parentNode)==null||x.removeChild(this.end.previousSibling);let d;this.end.previousSibling===this.start?(d=document.createTextNode(t),(E=this.end.parentNode)==null||E.insertBefore(d,this.end)):this.end.previousSibling.nodeType===Node.TEXT_NODE?(d=this.end.previousSibling,d.textContent=t):(d=document.createTextNode(t),(h=this.end.parentNode)==null||h.removeChild(this.end.previousSibling),(r=this.end.parentNode)==null||r.insertBefore(d,this.end))}},Re=function(e,t){e===t&&this.previous===this.element||(this.previous=this.element,this.previousName=e,Reflect.set(this.element,e,void 0),this.element.removeAttribute(e),this.name=t==null?void 0:t.toLowerCase(),this.name&&this.element.setAttribute(this.name,""))},Ae=function(e,t){var n;if(!(e===t&&this.previous===this.element))if(this.previous=this.element,this.name==="value"){if(this.value=F(t),!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else if(this.name.startsWith("on")){if(typeof e=="function"&&(this.element.removeEventListener(this.name.slice(2),e),this.previousName&&this.element.removeEventListener((n=this.previousName)==null?void 0:n.slice(2),e)),this.value=t,typeof this.value!="function")return console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);if(!this.name)return;this.element.addEventListener(this.name.slice(2),this.value)}else if(I(oe,this.name)){if(this.value=encodeURI(t),!this.name)return;if(ie(this.value)){this.element.removeAttribute(this.name),console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);return}Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else{if(this.value=t,!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}},Me=function(e,t){var s,l;if(e===t)return;let n=this.element,o=document.createElement(t);for(;n.firstChild;)o.appendChild(n.firstChild);let i=n.getAttributeNames();for(let c of i){let a=(s=n.getAttribute(c))!=null?s:"";o.setAttribute(c,a)}(l=n.parentNode)==null||l.replaceChild(o,n),this.element=o},re=function(e,t,n){var l,c,a,m,x;let o=new WeakSet,i=document.createTreeWalker(document,Ce,null);i.currentNode=e;let s=e.firstChild;for(;s=i.nextNode();)if(o.has(s.previousSibling)&&(o.delete(s.previousSibling),t.push(()=>{})),s.nodeType===Node.TEXT_NODE){let E=(c=(l=s.nodeValue)==null?void 0:l.indexOf(n))!=null?c:-1;if(E===-1)continue;E!==0&&(s.splitText(E),s=i.nextNode());let h=n.length;h!==((a=s.nodeValue)==null?void 0:a.length)&&s.splitText(h);let r=document.createTextNode(""),d=s;d.textContent="",(m=d.parentNode)==null||m.insertBefore(r,d),t.push(se.bind({marker:n,start:r,end:d,actions:[]}))}else if(s.nodeType===Node.ELEMENT_NODE){(s.nodeName==="SCRIPT"||s.nodeName==="STYLE")&&i.nextSibling();let E={element:s};s.nodeName===n&&(o.add(s),t.push(Me.bind(E)));let h=s.getAttributeNames();for(let r of h){let d=(x=s.getAttribute(r))!=null?x:"",p=r.toUpperCase().includes(n),b=d.includes(n);if(p||b){let f={name:r,value:d,previous:void 0,get element(){return E.element}};p&&(s.removeAttribute(r),t.push(Re.bind(f))),b&&(s.removeAttribute(r),t.push(Ae.bind(f)))}else I(oe,r)?ie(d)&&(s.removeAttribute(r),console.warn(`XElement - attribute name "${r}" and value "${d}" not allowed`)):r.startsWith("on")&&(s.removeAttribute(r),console.warn(`XElement - attribute name "${r}" not allowed`))}}else console.warn(`XElement - node type "${s.nodeType}" not handled`)},ae=re;var ce=function(e,t,n,o,i){if(typeof n=="symbol")return Reflect.set(t,n,o,i);let s=Reflect.get(t,n,i);return s===o||Number.isNaN(s)&&Number.isNaN(o)||(Reflect.set(t,n,o,i),e()),!0},le=function(e,t,n,o){var s,l,c,a;if(typeof n=="symbol")return Reflect.get(t,n,o);let i=Reflect.get(t,n,o);return((s=i==null?void 0:i.constructor)==null?void 0:s.name)==="Object"||((l=i==null?void 0:i.constructor)==null?void 0:l.name)==="Array"?new Proxy(i,{get:le.bind(null,e),set:ce.bind(null,e),deleteProperty:de.bind(null,e)}):((c=i==null?void 0:i.constructor)==null?void 0:c.name)==="Function"||((a=i==null?void 0:i.constructor)==null?void 0:a.name)==="AsyncFunction"?new Proxy(i,{apply:(m,x,E)=>Reflect.apply(m,o,E)}):i},de=function(e,t,n){return typeof n=="symbol"?Reflect.deleteProperty(t,n):(Reflect.deleteProperty(t,n),e(),!0)},Se=function(e,t){return new Proxy(e,{get:le.bind(null,t),set:ce.bind(null,t),deleteProperty:de.bind(null,t)})},he=Se;function S(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e}var ue=new Event("adopted"),me=new Event("adopting"),Ke=new Event("upgraded"),Ue=new Event("upgrading"),pe=new Event("creating"),fe=new Event("created"),_=new Event("rendering"),q=new Event("rendered"),ye=new Event("connected"),Ee=new Event("connecting"),xe=new Event("attributed"),ve=new Event("attributing"),be=new Event("disconnected"),we=new Event("disconnecting");var g=Symbol("change"),$,y,H,X,T,L,R,Le,D,z,V,ge,N=class extends HTMLElement{constructor(){var i;super();w(this,D);w(this,V);w(this,$,!1);w(this,y,{});w(this,H,void 0);w(this,X,"");w(this,T,[]);w(this,L,[]);w(this,R,void 0);this[Le]=void 0;let n=this.constructor;if(n.shadow&&!this.shadowRoot){let s=n.mode||"open";this.attachShadow({mode:s})}C(this,H,(i=this.shadowRoot)!=null?i:this)}static define(n=(o=>(o=this.tag)!=null?o:this.name)()){return n=S(n),M(n,this),this}static create(){return v(this,arguments,function*(n=(o=>(o=this.tag)!=null?o:this.name)()){n=S(n),M(n,this);let i=document.createElement(n);return yield i[g],i})}attributeChangedCallback(n,o,i){return v(this,null,function*(){var s,l;this.dispatchEvent(ve),yield(l=(s=this.attribute)==null?void 0:s.call(this,n,o,i))==null?void 0:l.catch(console.error),this.dispatchEvent(xe)})}adoptedCallback(){return v(this,null,function*(){var n,o;this.dispatchEvent(me),yield(o=(n=this.adopted)==null?void 0:n.call(this,u(this,y)))==null?void 0:o.catch(console.error),this.dispatchEvent(ue)})}connectedCallback(){return v(this,null,function*(){var n,o;u(this,$)||(C(this,$,!0),this[g]=j(this,V,ge).call(this),yield this[g]),this.dispatchEvent(Ee),yield(o=(n=this.connected)==null?void 0:n.call(this,u(this,y)))==null?void 0:o.catch(console.error),this.dispatchEvent(ye)})}disconnectedCallback(){return v(this,null,function*(){var n,o;this.dispatchEvent(we),yield(o=(n=this.disconnected)==null?void 0:n.call(this,u(this,y)))==null?void 0:o.catch(console.error),this.dispatchEvent(be)})}};Le=g,$=new WeakMap,y=new WeakMap,H=new WeakMap,X=new WeakMap,T=new WeakMap,L=new WeakMap,R=new WeakMap,D=new WeakSet,z=function(){return v(this,null,function*(){let n=()=>v(this,null,function*(){var i,s,l;this.dispatchEvent(_);let o=yield(i=this.render)==null?void 0:i.call(this,u(this,y));if(o)for(let c=0;c<u(this,T).length;c++){let a=o.expressions[c],m=u(this,L)[c];try{u(this,T)[c](m,a)}catch(x){console.error(x)}u(this,L)[c]=o.expressions[c]}yield(s=this.rendered)==null?void 0:s.call(this,u(this,y)),this.dispatchEvent(q),this[g]=(l=u(this,R))==null?void 0:l.call(this),C(this,R,void 0),yield this[g]});this[g]?C(this,R,n):this[g]=n()})},V=new WeakSet,ge=function(){return v(this,null,function*(){var c,a,m,x,E;let o=this.constructor.observedProperties,i=Object.getPrototypeOf(this),s=o?o!=null?o:[]:[...Object.getOwnPropertyNames(this),...Object.getOwnPropertyNames(i)];for(let h of s){if(h==="attributeChangedCallback"||h==="disconnectedCallback"||h==="connectedCallback"||h==="adoptedCallback"||h==="constructor"||h==="disconnected"||h==="attribute"||h==="connected"||h==="rendered"||h==="created"||h==="adopted"||h==="render"||h==="setup")continue;let r=(c=Object.getOwnPropertyDescriptor(this,h))!=null?c:Object.getOwnPropertyDescriptor(i,h);r&&r.configurable&&(typeof r.value=="function"&&(r.value=r.value.bind(this)),typeof r.get=="function"&&(r.get=r.get.bind(this)),typeof r.set=="function"&&(r.set=r.set.bind(this)),Object.defineProperty(u(this,y),h,r),Object.defineProperty(this,h,{enumerable:r.enumerable,configurable:!1,get(){return u(this,y)[h]},set(d){u(this,y)[h]=d,j(this,D,z).call(this)}}))}C(this,y,he(u(this,y),j(this,D,z).bind(this))),this.dispatchEvent(_);let l=yield(a=this.render)==null?void 0:a.call(this,u(this,y));if(l){let h=l.template.content.cloneNode(!0);C(this,X,l.marker),C(this,L,l.expressions),ae(h,u(this,T),u(this,X));for(let r=0;r<u(this,T).length;r++){let d=l.expressions[r];try{u(this,T)[r](void 0,d)}catch(p){console.error(p)}}document.adoptNode(h),u(this,H).appendChild(h)}yield(m=this.rendered)==null?void 0:m.call(this,u(this,y)),this.dispatchEvent(q),this[g]=(x=u(this,R))==null?void 0:x.call(this),C(this,R,void 0),yield this[g],this.dispatchEvent(pe),yield(E=this.created)==null?void 0:E.call(this,u(this,y)),this.dispatchEvent(fe)})},N.html=O;var U=[],Z=[],K=function(e){return v(this,null,function*(){var t,n;if(e.instance)B(e.root,e.instance);else{let o=yield e.handler();if((o==null?void 0:o.prototype)instanceof HTMLElement)e.construct=o;else if(((t=o==null?void 0:o.default)==null?void 0:t.prototype)instanceof HTMLElement)e.construct=o.default;else throw new Error("XElement - router handler requires a CustomElementConstructor");e.construct.prototype instanceof N?e.instance=yield e.construct.create():(e.tag=S((n=e.construct.tag)!=null?n:e.construct.name),M(e.tag,e.construct),e.instance=document.createElement(e.tag)),B(e.root,e.instance)}})},Pe=function(e){var s,l,c;if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL((s=e==null?void 0:e.destination.url)!=null?s:location.href),n=new URL((c=(l=document.querySelector("base"))==null?void 0:l.href)!=null?c:location.origin);n.hash="",n.search="",t.hash="",t.search="";let o=t.href.replace(n.href,"/"),i=[];for(let a of Z)a.path===o&&i.push(a);for(let a of U){let m=!1;for(let x of i)if(x.root===a.root){m=!0;break}m||i.push(a)}if(e!=null&&e.intercept)return e.intercept({handler:()=>i.map(a=>K(a))});if(e!=null&&e.transitionWhile)return e.transitionWhile(i.map(a=>K(a)));i.map(a=>K(a))},Oe=function(e,t,n){if(!e)throw new Error("XElement - router path required");if(!n)throw new Error("XElement - router handler required");if(!t)throw new Error("XElement - router root required");if(e==="/*"){for(let o of U)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");U.push({path:e,root:t,handler:n})}else{for(let o of Z)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");Z.push({path:e,root:t,handler:n,instance:void 0})}Reflect.get(window,"navigation").addEventListener("navigate",Pe)},G=Oe;var mt={Component:N,component:N,Router:G,router:G,html:O};export{N as Component,G as Router,N as component,mt as default,O as html,G as router};
//# sourceMappingURL=x-element.min.js.map
