/************************************************************************
Name: XElement
Version: 8.1.2
License: MPL-2.0
Author: Alexander Elias
Email: alex.steven.elis@gmail.com
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
************************************************************************/
var _=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};var m=(e,t,n)=>(_(e,t,"read from private field"),n?n.call(e):t.get(e)),w=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},b=(e,t,n,o)=>(_(e,t,"write to private field"),o?o.call(e,n):t.set(e,n),n);var $=(e,t,n)=>(_(e,t,"access private method"),n);var g=(e,t,n)=>new Promise((o,i)=>{var s=a=>{try{d(n.next(a))}catch(u){i(u)}},r=a=>{try{d(n.throw(a))}catch(u){i(u)}},d=a=>a.done?o(a.value):Promise.resolve(a.value).then(s,r);d((n=n.apply(e,t)).next())});function S(e,t){customElements.get(e)||customElements.define(e,t)}function I(e){switch(typeof e){case"undefined":return"";case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e);default:throw new Error("XElement - display type not handled")}}var te=()=>Math.floor(Math.random()*Date.now());var q=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t!=null&&t.length)for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)},z=function(e,t){return e.indexOf(t)!==-1},ne="trustedTypes"in window?window.trustedTypes.createPolicy("x-element",{createHTML:e=>e}):null,oe=function(e){return ne?ne.createHTML(e):e};var H=Symbol("html"),ie=new WeakMap;function X(e,...t){let n=ie.get(e);if(n){let[o,i]=n;return{strings:e,template:o,expressions:t,symbol:H,marker:i}}else{let o=`X-${te()}-X`,i="",s=e.length-1;for(let d=0;d<s;d++)i+=`${e[d]}${o}`;i+=e[s];let r=document.createElement("template");return r.innerHTML=oe(i),ie.set(e,[r,o]),{strings:e,template:r,expressions:t,symbol:H,marker:o}}}var Te=NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,se=["src","href","xlink:href"],Re=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,re=function(e){return e===""||typeof e!="string"?!1:!Re.test(e)},Ae=function(e,t){var o;let n=t.previousSibling;for(;n!==e;)(o=n==null?void 0:n.parentNode)==null||o.removeChild(n),n=t.previousSibling},ae=function(e,t){var n,o,i,s,r,d,a,u,x,c,l,v,p;if((t==null?void 0:t.symbol)===H)if(e=e!=null?e:{},t=t!=null?t:{},e.strings===t.strings){let h=this.actions.length;for(let f=0;f<h;f++)this.actions[f](e.expressions[f],t.expressions[f])}else{this.actions.length=0;let h=t.template.content.cloneNode(!0);ce(h,this.actions,t.marker);let f=this.actions.length;for(let C=0;C<f;C++)this.actions[C]((n=e.expressions)==null?void 0:n[C],t.expressions[C]);document.adoptNode(h),Ae(this.start,this.end),(o=this.end.parentNode)==null||o.insertBefore(h,this.end)}else if((t==null?void 0:t.constructor)===Array){e=e!=null?e:[],t=t!=null?t:[];let h=e.length,f=t.length,C=Math.min(h,f);for(let y=0;y<C;y++)this.actions[y](e[y],t[y]);if(h<f){let y=document.createElement("template");for(let M=h;M<f;M++){let V=document.createTextNode(""),Q=document.createTextNode(""),ee=ae.bind({start:V,end:Q,actions:[]});y.content.appendChild(V),y.content.appendChild(Q),this.actions.push(ee),ee(e[M],t[M])}(i=this.end.parentNode)==null||i.insertBefore(y.content,this.end)}else if(h>f){for(let y=h-1;y>f-1;y--)if(((s=e[y])==null?void 0:s.symbol)===H){let{template:M}=e[y],V=M.content.childNodes.length+2;for(;V--;)(r=this.end.parentNode)==null||r.removeChild(this.end.previousSibling)}else(d=this.end.parentNode)==null||d.removeChild(this.end.previousSibling),(a=this.end.parentNode)==null||a.removeChild(this.end.previousSibling),(u=this.end.parentNode)==null||u.removeChild(this.end.previousSibling);this.actions.length=f}}else{if(e===t)return;if(typeof e!=typeof t)for(;this.end.previousSibling!==this.start;)(x=this.end.parentNode)==null||x.removeChild(this.end.previousSibling);let h;this.end.previousSibling===this.start?(h=document.createTextNode(t),(c=this.end.parentNode)==null||c.insertBefore(h,this.end)):((l=this.end.previousSibling)==null?void 0:l.nodeType)===Node.TEXT_NODE?(h=this.end.previousSibling,h.textContent=t):(h=document.createTextNode(t),(v=this.end.parentNode)==null||v.removeChild(this.end.previousSibling),(p=this.end.parentNode)==null||p.insertBefore(h,this.end))}},Me=function(e,t){e!==t&&(e!=null&&e.startsWith("on")&&typeof this.value=="function"&&this.element.removeEventListener(e.slice(2),this.value),Reflect.set(this.element,e,void 0),this.element.removeAttribute(e),this.name=t==null?void 0:t.toLowerCase(),this.name&&this.element.setAttribute(this.name,""))},Se=function(e,t){if(e!==t)if(this.name==="value"){if(this.value=I(t),!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else if(this.name.startsWith("on")){if(!this.name)return;if(typeof this.value=="function"&&this.element.removeEventListener(this.name.slice(2),this.value,!0),this.value=t,typeof this.value!="function")return console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);this.element.addEventListener(this.name.slice(2),this.value,!0)}else if(z(se,this.name)){if(this.value=encodeURI(t),!this.name)return;if(re(this.value)){this.element.removeAttribute(this.name),console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);return}Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else{if(this.value=t,!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}},Pe=function(e,t){var o,i,s,r;if(e===t)return;let n=this.element;if(t){(o=n.parentNode)==null||o.removeChild(n);let d=document.createElement(t);for(;n.firstChild;)d.appendChild(n.firstChild);if(n.nodeType===Node.ELEMENT_NODE){let a=n.getAttributeNames();for(let u of a){let x=(i=n.getAttribute(u))!=null?i:"";d.setAttribute(u,x)}}(s=this.holder.parentNode)==null||s.insertBefore(d,this.holder),this.element=d}else(r=n.parentNode)==null||r.removeChild(n),this.element=n},ce=function(e,t,n){var r,d,a,u,x,c;let o=new WeakSet,i=document.createTreeWalker(document,Te,null);i.currentNode=e;let s=e.firstChild;for(;s=i.nextNode();)if(o.has(s.previousSibling)&&(o.delete(s.previousSibling),t.push(()=>{})),s.nodeType===Node.TEXT_NODE){let l=(d=(r=s.nodeValue)==null?void 0:r.indexOf(n))!=null?d:-1;if(l===-1)continue;l!==0&&(s.splitText(l),s=i.nextNode());let v=n.length;v!==((a=s.nodeValue)==null?void 0:a.length)&&s.splitText(v);let p=document.createTextNode(""),h=s;h.textContent="",(u=h.parentNode)==null||u.insertBefore(p,h),t.push(ae.bind({marker:n,start:p,end:h,actions:[]}))}else if(s.nodeType===Node.ELEMENT_NODE){(s.nodeName==="SCRIPT"||s.nodeName==="STYLE")&&i.nextSibling();let l={element:s};s.nodeName===n&&(o.add(s),l.holder=document.createTextNode(""),(x=s.parentNode)==null||x.insertBefore(l.holder,s),t.push(Pe.bind(l)));let v=s.getAttributeNames();for(let p of v){let h=(c=s.getAttribute(p))!=null?c:"",f=p.toUpperCase().includes(n),C=h.includes(n);if(f||C){let y={name:p,value:h,previous:void 0,get element(){return l.element}};f&&(s.removeAttribute(p),t.push(Me.bind(y))),C&&(s.removeAttribute(p),t.push(Se.bind(y)))}else z(se,p)?re(h)&&(s.removeAttribute(p),console.warn(`XElement - attribute name "${p}" and value "${h}" not allowed`)):p.startsWith("on")&&(s.removeAttribute(p),console.warn(`XElement - attribute name "${p}" not allowed`))}}else console.warn(`XElement - node type "${s.nodeType}" not handled`)},le=ce;var de=function(e,t,n,o,i){if(typeof n=="symbol")return Reflect.set(t,n,o,i);let s=Reflect.get(t,n,i);return s===o||Number.isNaN(s)&&Number.isNaN(o)||(Reflect.set(t,n,o,i),e()),!0},he=function(e,t,n,o){var s,r,d,a;if(typeof n=="symbol")return Reflect.get(t,n,o);let i=Reflect.get(t,n,o);return((s=i==null?void 0:i.constructor)==null?void 0:s.name)==="Object"||((r=i==null?void 0:i.constructor)==null?void 0:r.name)==="Array"?new Proxy(i,{get:he.bind(null,e),set:de.bind(null,e),deleteProperty:me.bind(null,e)}):((d=i==null?void 0:i.constructor)==null?void 0:d.name)==="Function"||((a=i==null?void 0:i.constructor)==null?void 0:a.name)==="AsyncFunction"?new Proxy(i,{apply:(u,x,c)=>Reflect.apply(u,o,c)}):i},me=function(e,t,n){return typeof n=="symbol"?Reflect.deleteProperty(t,n):(Reflect.deleteProperty(t,n),e(),!0)},Le=function(e,t){return new Proxy(e,{get:he.bind(null,t),set:de.bind(null,t),deleteProperty:me.bind(null,t)})},ue=Le;function P(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e}var pe=new Event("adopted"),fe=new Event("adopting"),Ze=new Event("upgraded"),Ge=new Event("upgrading"),ye=new Event("creating"),Ee=new Event("created"),K=new Event("rendering"),U=new Event("rendered"),xe=new Event("connected"),be=new Event("connecting"),ve=new Event("attributed"),we=new Event("attributing"),ge=new Event("disconnected"),Ce=new Event("disconnecting");var it=Promise.resolve(),D=Symbol("change"),k,E,W,j,T,L,R,A,Oe,O,B,F,Ne,N=class extends HTMLElement{constructor(){var i;super();w(this,O);w(this,F);w(this,k,!1);w(this,E,{});w(this,W,void 0);w(this,j,"");w(this,T,[]);w(this,L,[]);w(this,R,!1);w(this,A,!1);this[Oe]=Promise.resolve();let n=this.constructor;if(n.shadow&&!this.shadowRoot){let s=n.mode||"open";this.attachShadow({mode:s})}b(this,W,(i=this.shadowRoot)!=null?i:this)}static define(n=(o=>(o=this.tag)!=null?o:this.name)()){return n=P(n),S(n,this),this}static create(){return g(this,arguments,function*(n=(o=>(o=this.tag)!=null?o:this.name)()){n=P(n),S(n,this);let i=document.createElement(n);return yield i[D],i})}attributeChangedCallback(n,o,i){return g(this,null,function*(){var s,r;this.dispatchEvent(we),yield(r=(s=this.attribute)==null?void 0:s.call(this,n,o,i))==null?void 0:r.catch(console.error),this.dispatchEvent(ve)})}adoptedCallback(){return g(this,null,function*(){var n,o;this.dispatchEvent(fe),yield(o=(n=this.adopted)==null?void 0:n.call(this,m(this,E)))==null?void 0:o.catch(console.error),this.dispatchEvent(pe)})}connectedCallback(){return g(this,null,function*(){var n,o;m(this,k)||(b(this,k,!0),b(this,R,!0),yield $(this,F,Ne).call(this)),this.dispatchEvent(be),yield(o=(n=this.connected)==null?void 0:n.call(this,m(this,E)))==null?void 0:o.catch(console.error),this.dispatchEvent(xe)})}disconnectedCallback(){return g(this,null,function*(){var n,o;this.dispatchEvent(Ce),yield(o=(n=this.disconnected)==null?void 0:n.call(this,m(this,E)))==null?void 0:o.catch(console.error),this.dispatchEvent(ge)})}};Oe=D,k=new WeakMap,E=new WeakMap,W=new WeakMap,j=new WeakMap,T=new WeakMap,L=new WeakMap,R=new WeakMap,A=new WeakMap,O=new WeakSet,B=function(){return g(this,null,function*(){if(m(this,R)){b(this,A,!0);return}b(this,R,!0);let n=()=>g(this,null,function*(){var i,s;this.dispatchEvent(K);let o=yield(i=this.render)==null?void 0:i.call(this,m(this,E));if(o)for(let r=0;r<m(this,T).length;r++){if(m(this,A)){yield new Promise(u=>setTimeout(u,60)),r=-1,b(this,A,!1);continue}let d=o.expressions[r],a=m(this,L)[r];try{m(this,T)[r](a,d)}catch(u){console.error(u)}m(this,L)[r]=o.expressions[r]}b(this,R,!1),yield(s=this.rendered)==null?void 0:s.call(this,m(this,E)),this.dispatchEvent(U)});setTimeout(()=>{this[D]=this[D].then(n)},60)})},F=new WeakSet,Ne=function(){return g(this,null,function*(){var d,a,u,x;let o=this.constructor.observedProperties,i=Object.getPrototypeOf(this),s=o?o!=null?o:[]:[...Object.getOwnPropertyNames(this),...Object.getOwnPropertyNames(i)];for(let c of s){if(c==="attributeChangedCallback"||c==="disconnectedCallback"||c==="connectedCallback"||c==="adoptedCallback"||c==="constructor"||c==="disconnected"||c==="attribute"||c==="connected"||c==="rendered"||c==="created"||c==="adopted"||c==="render"||c==="setup")continue;let l=(d=Object.getOwnPropertyDescriptor(this,c))!=null?d:Object.getOwnPropertyDescriptor(i,c);l&&l.configurable&&(typeof l.value=="function"&&(l.value=l.value.bind(this)),typeof l.get=="function"&&(l.get=l.get.bind(this)),typeof l.set=="function"&&(l.set=l.set.bind(this)),Object.defineProperty(m(this,E),c,l),Object.defineProperty(this,c,{enumerable:l.enumerable,configurable:!1,get(){return m(this,E)[c]},set(v){m(this,E)[c]=v,$(this,O,B).call(this)}}))}b(this,E,ue(m(this,E),$(this,O,B).bind(this))),this.dispatchEvent(K);let r=yield(a=this.render)==null?void 0:a.call(this,m(this,E));if(r){let c=r.template.content.cloneNode(!0);b(this,j,r.marker),b(this,L,r.expressions),le(c,m(this,T),m(this,j));for(let l=0;l<m(this,T).length;l++){let v=r.expressions[l];try{m(this,T)[l](void 0,v)}catch(p){console.error(p)}}document.adoptNode(c),m(this,W).appendChild(c)}yield(u=this.rendered)==null?void 0:u.call(this,m(this,E)),this.dispatchEvent(U),b(this,A,!1),b(this,R,!1),$(this,O,B).call(this),yield this[D],this.dispatchEvent(ye),yield(x=this.created)==null?void 0:x.call(this,m(this,E)),this.dispatchEvent(Ee)})},N.html=X;var G=[],J=[],Z=function(e){return g(this,null,function*(){var t,n;if(e.instance)q(e.root,e.instance);else{let o=yield e.handler();if((o==null?void 0:o.prototype)instanceof HTMLElement)e.construct=o;else if(((t=o==null?void 0:o.default)==null?void 0:t.prototype)instanceof HTMLElement)e.construct=o.default;else throw new Error("XElement - router handler requires a CustomElementConstructor");e.construct.prototype instanceof N?e.instance=yield e.construct.create():(e.tag=P((n=e.construct.tag)!=null?n:e.construct.name),S(e.tag,e.construct),e.instance=document.createElement(e.tag)),q(e.root,e.instance)}})},$e=function(e){var s,r,d;if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL((s=e==null?void 0:e.destination.url)!=null?s:location.href),n=new URL((d=(r=document.querySelector("base"))==null?void 0:r.href)!=null?d:location.origin);n.hash="",n.search="",t.hash="",t.search="";let o=t.href.replace(n.href,"/"),i=[];for(let a of J)a.path===o&&i.push(a);for(let a of G){let u=!1;for(let x of i)if(x.root===a.root){u=!0;break}u||i.push(a)}if(e!=null&&e.intercept)return e.intercept({handler:()=>i.map(a=>Z(a))});if(e!=null&&e.transitionWhile)return e.transitionWhile(i.map(a=>Z(a)));i.map(a=>Z(a))},He=function(e,t,n){if(!e)throw new Error("XElement - router path required");if(!n)throw new Error("XElement - router handler required");if(!t)throw new Error("XElement - router root required");if(e==="/*"){for(let o of G)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");G.push({path:e,root:t,handler:n})}else{for(let o of J)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");J.push({path:e,root:t,handler:n,instance:void 0})}Reflect.get(window,"navigation").addEventListener("navigate",$e)},Y=He;var yt={Component:N,component:N,Router:Y,router:Y,html:X};export{N as Component,Y as Router,N as component,yt as default,X as html,Y as router};
//# sourceMappingURL=x-element.min.js.map
