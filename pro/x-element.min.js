/************************************************************************
Name: XElement
Version: 8.0.0
License: MPL-2.0
Author: Alexander Elias
Email: alex.steven.elis@gmail.com
This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
************************************************************************/
var x=(e,t,r)=>new Promise((n,o)=>{var s=i=>{try{d(r.next(i))}catch(m){o(m)}},a=i=>{try{d(r.throw(i))}catch(m){o(m)}},d=i=>i.done?n(i.value):Promise.resolve(i.value).then(s,a);d((r=r.apply(e,t)).next())});var $=!1,ie=()=>new Promise(e=>setTimeout(e,0)),M=[],F=[],I=[];function C(e,t,r){return x(this,null,function*(){var d;if(e=e!=null?e:[],t=t!=null?t:[],r=r!=null?r:[],M.push(...e),F.push(...t),I.push(...r),$)return;$=!0;let n,o,s,a=performance.now()+50;for(;M.length>0;){if((d=navigator.scheduling)!=null&&d.isInputPending()||performance.now()>=a){yield ie(),a=performance.now()+50;continue}n=M.shift(),o=F.shift(),s=I.shift(),o!==s&&(yield n(o,s))}$=!1})}function L(e,t){customElements.define(e,t)}var z=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t!=null&&t.length)for(let r of t)e.appendChild(typeof r=="string"?e.ownerDocument.createTextNode(r):r)},E=function(e,t){return e.indexOf(t)!==-1},K="trustedTypes"in window?window.trustedTypes.createPolicy("default",{createHTML:e=>e}):null,_=function(e){return K?K.createHTML(e):e};var P=new WeakMap,O=Symbol("html");function A(e,...t){if(P.has(e)){let r=P.get(e);return{strings:e,values:t,template:r,symbol:O}}else{let r="",n=e.length-1;for(let s=0;s<n;s++)r+=`${e[s]}{{${s}}}`;r+=e[n];let o=document.createElement("template");return o.innerHTML=_(r),P.set(e,o),{strings:e,values:t,template:o,symbol:O}}}function S(e){switch(typeof e){case"undefined":return"";case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e);default:throw new Error("display - type not handled")}}var N=new WeakMap,U=Promise.resolve(),G=function(e,t,r,n,o){if(typeof r=="symbol")return Reflect.set(t,r,n,o);let s=Reflect.get(t,r,o);if(s===n||Number.isNaN(s)&&Number.isNaN(n))return!0;if(s&&(s.constructor.name==="Object"||s.constructor.name==="Array"||s.constructor.name==="Function")){if(N.get(s)===n)return!0;N.delete(s)}return Reflect.set(t,r,n,o),U.then(e),!0},J=function(e,t,r,n){if(typeof r=="symbol")return Reflect.get(t,r,n);let o=Reflect.get(t,r,n);if(o&&(o.constructor.name==="Object"||o.constructor.name==="Array")){let s=N.get(o);if(s)return s;let a=new Proxy(o,{get:J.bind(null,e),set:G.bind(null,e),deleteProperty:Q.bind(null,e)});return N.set(o,a),a}if(o&&t.constructor.name==="Object"&&(o.constructor.name==="Function"||o.constructor.name==="AsyncFunction")){let s=N.get(o);if(s)return s;let a=new Proxy(o,{apply(d,i,m){return Reflect.apply(d,n,m)}});return N.set(o,a),a}return o},Q=function(e,t,r){if(typeof r=="symbol")return Reflect.deleteProperty(t,r);let n=Reflect.get(t,r);return N.delete(n),Reflect.deleteProperty(t,r),U.then(e),!0},ae=function(e,t){return new Proxy(e,{get:J.bind(null,t),set:G.bind(null,t),deleteProperty:Q.bind(null,t)})},Y=ae;var le=["allowfullscreen","async","autofocus","autoplay","checked","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","defer","disabled","draggable","enabled","formnovalidate","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noshade","hidden","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","selected","sortable","spellcheck","translate","truespeed","typemustmatch","visible"],X=le;var D=["src","href","xlink:href"],ue=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,V=function(e){return typeof e!="string"||!ue.test(e)},Z=new WeakMap,ee=function(e,t,r,n,o){var s,a,d,i;if(n=n!=null?n:{},o=o!=null?o:{},(n==null?void 0:n.strings)!==o.strings){let m,u=t.previousSibling;for(;u!==e;)m=u==null?void 0:u.previousSibling,(s=u==null?void 0:u.parentNode)==null||s.removeChild(u),u=m;let b=o.template.content.cloneNode(!0);se(b,o.values,r),document.adoptNode(b);let v=r.length;for(let h=0;h<v;h++)r[h]((a=n.values)==null?void 0:a[h],o.values[h]);(d=t.parentNode)==null||d.insertBefore(b,t)}else{let m=r.length;for(let u=0;u<m;u++)r[u]((i=n.values)==null?void 0:i[u],o.values[u])}},fe=function(e,t,r,n,o){var i,m,u,b,v,h,g;n=n!=null?n:[],o=o!=null?o:[];let s=n.length,a=o.length,d=Math.min(s,a);for(let c=0;c<d;c++)r[c](n[c],o[c]);if(s<a){let c=document.createElement("template");for(let l=s;l<a;l++)if(((i=o[l])==null?void 0:i.constructor)===Object&&((m=o[l])==null?void 0:m.symbol)===O){let f=document.createTextNode(""),p=document.createTextNode(""),y=ee.bind(null,f,p,[]);c.content.appendChild(f),c.content.appendChild(p),r.push(y),y(n[l],o[l])}else{let f=document.createTextNode(""),p=te.bind(null,f);c.content.appendChild(f),r.push(p),p(n[l],o[l])}(u=t.parentNode)==null||u.insertBefore(c.content,t)}else if(s>a){for(let c=s-1;c>a-1;c--)if(((b=n[c])==null?void 0:b.constructor)===Object&&((v=n[c])==null?void 0:v.symbol)===O){let{template:l}=n[c],f=l.content.childNodes.length+2;for(;f--;)(h=t.parentNode)==null||h.removeChild(t.previousSibling)}else(g=t.parentNode)==null||g.removeChild(t.previousSibling);r.length=a}},te=function(e,t,r){t!==r&&(e.textContent=r)},de=function(e,t,r,n){if(r!==n){if(typeof r=="function"&&e.removeEventListener(t.name.slice(2),r),typeof n!="function")return console.warn(`XElement - attribute name "${t.name}" and value "${n}" not allowed`);e.addEventListener(t.name.slice(2),n)}},ne=function(e,t,r,n){if(r===n)return;let o=!!n;o?e.setAttribute(t.name,""):e.removeAttribute(t.name),t.value=o,Reflect.set(e,t.name,t.value)},re=function(e,t,r,n){if(r===n)return;let o=S(n);t.value=o,Reflect.set(e,t.name,t.value),e.setAttribute(t.name,t.value)},me=function(e,t,r,n){if(r!==n){if(V(n)){e.removeAttribute(t.name),console.warn(`XElement - attribute name "${t.name}" and value "${n}" not allowed`);return}t.value=n,Reflect.set(e,t.name,t.value),e.setAttribute(t.name,t.value)}},oe=function(e,t,r,n){r!==n&&(t.value=n,Reflect.set(e,t.name,t.value),e.setAttribute(t.name,t.value))},pe=function(e,t,r,n){if(r===n)return;e.removeAttribute(r);let o=n==null?void 0:n.toLowerCase();o==="value"?(t.name=o,re(e,t,t.value,t.value)):o.startsWith("on")?console.warn(`XElement - dynamic attribute name "${n}" not allowed`):E(D,o)?console.warn(`XElement - dynamic attribute name "${n}" not allowed`):E(X,o)?(t.name=o,ne(e,t,t.value,t.value)):(t.name=o,oe(e,t,t.value,t.value))},se=function(e,t,r){var a,d,i,m,u,b,v,h;let n=document.createTreeWalker(document,5,null);n.currentNode=e;let o=0,s=e.firstChild;for(;(s=n.nextNode())!==null;)if(s.nodeType===Node.TEXT_NODE){let g=(d=(a=s.nodeValue)==null?void 0:a.indexOf("{{"))!=null?d:-1;if(g==-1)continue;g!=0&&(s.splitText(g),s=n.nextNode());let c=(m=(i=s.nodeValue)==null?void 0:i.indexOf("}}"))!=null?m:-1;if(c==-1)continue;c+2!=((u=s.nodeValue)==null?void 0:u.length)&&s.splitText(c+2);let l=t[o++];if((l==null?void 0:l.constructor)===Object&&(l==null?void 0:l.symbol)===O){let f=document.createTextNode(""),p=s;p.nodeValue="",(b=p.parentNode)==null||b.insertBefore(f,p),r.push(ee.bind(null,f,p,[]))}else if((l==null?void 0:l.constructor)===Array){let f=document.createTextNode(""),p=s;p.nodeValue="",(v=p.parentNode)==null||v.insertBefore(f,p),r.push(fe.bind(null,f,p,[]))}else s.textContent="",r.push(te.bind(null,s))}else if(s.nodeType===Node.ELEMENT_NODE){let g=s.getAttributeNames();for(let c of g){let l=(h=s.getAttribute(c))!=null?h:"",f={name:c,value:l},p=c.includes("{{")&&c.includes("}}"),y=l.includes("{{")&&l.includes("}}");p&&(o++,s.removeAttribute(c),r.push(pe.bind(null,s,f))),y&&(o++,s.removeAttribute(c),c==="value"?r.push(re.bind(null,s,f)):c.startsWith("on")?r.push(de.bind(null,s,f)):E(D,c)?r.push(me.bind(null,s,f)):E(X,c)?r.push(ne.bind(null,s,f)):r.push(oe.bind(null,s,f))),!p&&!y&&(E(D,c)?V(l)&&(s.removeAttribute(c),console.warn(`XElement - attribute name "${c}" and value "${l}" not allowed`)):c.startsWith("on")&&(s.removeAttribute(c),console.warn(`XElement - attribute name "${c}" not allowed`)))}}else console.warn("node type not handled ",s.nodeType)},he=e=>new Promise(t=>setTimeout(t,e!=null?e:0)),ye=function(e,t,r){return x(this,null,function*(){var u,b,v,h,g,c,l,f,p;let n={},o=function(){return x(this,null,function*(){var R,q,B;if(n.busy)return;n.busy=!0,yield he(50),t.upgrade&&(yield(q=(R=t.upgrade())==null?void 0:R.catch)==null?void 0:q.call(R,console.error));let{values:y}=r(A,t),ce=n.actions.length;for(let T=0;T<ce;T++)n.actions[T](n.values[T],y[T]);n.values=y,t.upgraded&&(yield(B=t.upgraded())==null?void 0:B.catch(console.error)),n.busy=!1})},s=Z.get(e);s&&s.disconnect&&(yield(b=(u=s.disconnect())==null?void 0:u.catch)==null?void 0:b.call(u,console.error)),s&&s.disconnected&&(yield(v=s.disconnected())==null?void 0:v.catch(console.error)),t=Y(t(A),o),Z.set(e,t),t.connect&&(yield(g=(h=t.connect())==null?void 0:h.catch)==null?void 0:g.call(h,console.error)),t.upgrade&&(yield(l=(c=t.upgrade())==null?void 0:c.catch)==null?void 0:l.call(c,console.error));let{strings:a,values:d,template:i}=r(A,t);n.busy=!1,n.actions=[],n.values=d,n.strings=a,n.template=i,n.fragment=i.content.cloneNode(!0),se(n.fragment,n.values,n.actions),document.adoptNode(n.fragment);let m=n.actions.length;for(let y=0;y<m;y++)n.actions[y](void 0,d[y]);e.replaceChildren?e.replaceChildren(n.fragment):z(e,n.fragment),t.upgraded&&(yield(f=t.upgraded())==null?void 0:f.catch(console.error)),t.connected&&(yield(p=t.connected())==null?void 0:p.catch(console.error))})},w=ye;var j=[],H=[],W=function(e){return x(this,null,function*(){yield w(e.root,e.context,e.content)})},be=function(e){var s,a,d;if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL((s=e==null?void 0:e.destination.url)!=null?s:location.href),r=new URL((d=(a=document.querySelector("base"))==null?void 0:a.href)!=null?d:location.origin);r.hash="",r.search="",t.hash="",t.search="";let n=t.href.replace(r.href,"/"),o=[];for(let i of H)i.path===n&&i.root&&(Reflect.set(i.root,"xRouterPath",i.path),o.push(i));for(let i of j){if(!i.root)continue;let m=!1;for(let u of o)if(u.root===i.root){m=!0;break}m||Reflect.get(i.root,"xRouterPath")!==n&&o.push(i)}if(e!=null&&e.intercept)return e.intercept({handler:()=>o.map(i=>W(i))});if(e!=null&&e.transitionWhile)return e.transitionWhile(o.map(i=>W(i)));o.map(i=>W(i))},ge=function(e,t,r,n){if(!e)throw new Error("XElement - router path required");if(!t)throw new Error("XElement - router root required");if(!r)throw new Error("XElement - router context required");if(!n)throw new Error("XElement - router content required");if(e==="/*"){for(let o of j)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");j.push({path:e,root:t,context:r,content:n})}else{for(let o of H)if(o.path===e&&o.root===t)throw new Error("XElement - router duplicate path on root");H.push({path:e,root:t,context:r,content:n})}Reflect.get(window,"navigation").addEventListener("navigate",be)},k=ge;var ve={Schedule:C,Define:L,Router:k,Render:w,schedule:C,define:L,router:k,render:w},ze=ve;export{L as Define,w as Render,k as Router,C as Schedule,ze as default,L as define,w as render,k as router,C as schedule};
//# sourceMappingURL=x-element.min.js.map
