<style>
    :not(:defined) {
        visibility: hidden;
    }

    :root>* {
        margin: 0;
        padding: 0;
        text-align: center;
    }

    /* body,
    o-loop {
        width: 100%;
        height: 3000px;
        display: block;
    } */

    .box {
        width: 60px;
        margin: 1px;
        font-size: 12px;
        text-align: center;
        display: inline-block;
        background: lightgray;
    }

    .box input {
        width: 90%;
        margin: auto;
        display: block;
    }

    .wrap {
        overflow: hidden;
    }
</style>

<main></main>

<x-e></x-e>

<script type="module">
    import { XElement } from './virtual.js';
    import { render } from './virtual.js';

    const context = () => ({
        count: 0,
        list: [],
        message: 'hello world',
        overwrite() {
            this.list = this.list.length ? [] : Array.from({ length: 10_000 }, (v, i) => i);
        },
        increment() {
            this.count++;
        }
    });

    const component = ({ h1, div, br, button }, { message, count, list, increment, overwrite }) => [
        h1({ style: 'background:red' }, message),
        div(`Count: ${count}`),
        button({ onclick: increment }, 'Increment Count'),
        button({ onclick: overwrite }, 'Overwrite List'),
        div(...list.map((i) => div({ class: 'box' }, `${i}`)))
    ];

    const root = () => document.querySelector('main');

    render(root, context, component);

    class XE extends XElement {
        static context = context;
        static component = component;
        static options = { root: 'this', slot: 'default' };
    }
    customElements.define('x-e', XE);
</script>