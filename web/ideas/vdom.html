<main></main>

<script type="module">
    import Virtual from './virtual.js';

    const context = () => ({
        count: 0,
        list: [],
        message: 'hello world',
        overwrite() {
            this.list = [1, 2, 3, 4, 5];
        },
        increment() {
            this.count++;
        }
    });

    const render = (
        { message, count, list, increment, overwrite },
        { h1, div, span, button }
    ) => [
            h1({ style: 'background:red' }, message),

            ...list.map(i => span({}, `${i}`)),

            div({}, `List: ${list}`),
            button({ onclick: overwrite }, 'Overwrite List'),

            div({}, `Count: ${count}`),
            button({ onclick: increment }, 'Increment Count'),

        ];

    const root = () => document.querySelector('main')
    const virtual = new Virtual(root, context, render);

    virtual.render();




    // class CustomElement extends XVirtual {

    //     users = [];
    //     count = 0;
    //     message = 'hello world';
    //     onclick() { this.count++; }
    //     message() { return 'hello world'; }

    //     virtual = ({ h1, p, button }, { message, count, onclick })[
    //         h1({}, 'one two'),
    //         h1({ id: 'red' }, message()),
    //         p({ class: 'blue' }, `Count: ${count}`),
    //         button({ created, onclick: () => count++ }, 'click me')
    //     ];

    //     constructor() {
    //         // render(root, this, virtual);
    //     }

    //     connectedCallback() {
    //         this.users = fetch();
    //     }

    // }


    // const Primitive = function (value) {
    //     function Primitive(data) {
    //         return data === undefined ? value : value = data;
    //     }
    //     Primitive[Symbol.toPrimitive] = function () { return value; }
    //     // Primitive[Symbol.toStringTag] = function () { return 'Validator'; }
    //     Primitive[Symbol.hasInstance] = function (instance) {
    //         console.log(instance);
    //         return value instanceof instance;
    //     }
    //     return Primitive
    // }

    // let o = new Proxy({
    //     count: Primitive(10),
    //     string: Primitive('hello')
    // }, {
    //     construct(...args) {
    //         console.log(args)
    //         return Reflect.construct(...args);
    //     },
    //     get(target, key, receiver) {
    //         console.log('get', key)
    //         return Reflect.get(target, key, receiver);
    //     },
    //     set(target, key, value, receiver) {
    //         console.log('set', key)
    //         return Reflect.set(target, key, value, receiver);
    //     },
    //     apply(...args) {
    //         console.log(args);
    //         return Reflect.apply(...args);
    //     }
    // });

    // let { count, string } = o;

    // console.log(count());
    // console.log(count++)
    // console.log(count);
    // console.log(typeof count);
    // console.log(count instanceof Number)
    // console.log(Object.prototype.toString.call(count));

    // console.log(string());
    // console.log(string += ' world');
    // console.log(string);
    // console.log(typeof string);
    // console.log(string instanceof String)
    // console.log(Object.prototype.toString.call(string));

</script>