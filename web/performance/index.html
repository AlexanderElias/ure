<base href="/">
<title>XElement Performance</title>
<script>document.querySelector('base').href = location.pathname.startsWith('/element') ? '/element/performance/' : '/';</script>
<link rel="stylesheet" href="./index.css">

<h1>XElement Performance</h1>
<o-loop></o-loop>

<!--
<o-loop>
    <template shadowroot="open">
        <link rel="stylesheet" href="./index.css">
        <h3>test {{count.toLocaleString()}}</h3>
        <input value="{{count}}" oninput="{{count = this.valueAsNumber}}" type="number" />
        <br>
        <button onclick="{{push()}}">push</button>
        <button onclick="{{overwrite()}}">overwrite</button>
        <button onclick="{{raw()}}">raw</button>
        <button onclick="{{clear()}}">clear</button>
        <div id="raw"></div>
        <div each="{{[items,'item']}}">
            <div class="box">{{item}}</div>
        </div>
        <slot></slot>
    </template>

    <br>

    <br>

    <br>
    <div>{{number}}</div>
    <select value="{{number}}" oninput="{{number=JSON.parse(this.value)}}">
        <option value="{{0}}">zero</option>
        <option value="{{1}}">one</option>
        <option value="{{2}}">two</option>
    </select>
    <div>{{boolean}}</div>
    <select value="{{boolean}}" oninput="{{boolean=JSON.parse(this.value)}}">
        <option value="{{true}}">yes</option>
        <option value="{{false}}">no</option>
    </select>
    <div>{{string}}</div>
    <select value="{{string}}" oninput="{{string=this.value}}">
        <option value="{{'foo'}}">foo</option>
        <option value="{{'bar'}}">bar</option>
    </select>
    <br>

    <br>
    <div>{{date?.toLocaleString()}}</div>
    <input value="{{date}}" oninput="{{date=this.valueAsNumber}}" type="date" />
    <div>{{time?.toLocaleString()}}</div>
    <input x-value="{{time}}" oninput="{{time=this.valueAsNumber}}" type="time" />
    <div>{{datetime}}</div>
    <input x-value="datetime" oninput="{{datetime = this.valueAsNumber}}" type="datetime-local" />
    <br>

    <h3>test {{count.toLocaleString()}}</h3>
    <input x-value="{{count}}" oninput="{{count = this.valueAsNumber}}" type="number" />

    <br>

    <button onclick="{{push()}}">push</button>
    <button onclick="{{overwrite()}}">overwrite</button>
    <button onclick="{{raw()}}">raw</button>
    <button onclick="{{clear()}}">clear</button>

    <div id="raw"></div>

    <div each="{{[items,'item']}}">
        <div class="box">{{item}}</div>
    </div>
</o-loop>
-->

<script type="module">
    import { XElement } from '../x-element.js';

    const context = () => ({

        time: Date.now(),
        date: Date.now(),
        datetime: Date.now(),

        number: 1,
        boolean: true,
        string: 'foo',

        checked: false,
        radioShared: '',
        radioOne: 'one',
        radioTwo: 'two',

        item: undefined,
        items: [],
        message: '',
        count: 100000,

        oninput(e) {
            this.count = e.target.valueAsNumber;
        },

        push() {
            console.time('push');
            for (var i = 0; i < this.count; i++) this.items.push(i);
            console.timeEnd('push');
        },

        overwrite() {
            console.time('overwrite');
            var items = [];
            for (var i = 0; i < this.count; i++) items.push(i);
            this.items = items;
            console.timeEnd('overwrite');
        },

        clear() {
            this.items = [];
        },

    });

    const component = (
        { h2, input, button, div, br },
        // { count, oninput, push, overwrite, clear, items }
        c
    ) => [
            // h2(`Count ${count}`),
            // input({ oninput, value: count, type: 'number' }),
            // button({ onclick: push }, 'push'),
            // button({ onclick: overwrite }, 'overwrite'),
            // button({ onclick: clear }, 'clear'),
            // div(...items.map(item => div({ class: 'box' }, `${item}`)))

            br(),
            div(c.radioShared),
            input().type('radio').name('radio').checked(() => c.radioShared === radioOne).oninput(() => c.radioShared = 'one'),
            input().type('radio').name('radio').checked(() => c.radioShared === radioTwo).oninput(() => c.radioShared = 'two'),
            br(),

            h2(`Count: ${c.count.toLocaleString()}`),
            input().oninput(c.oninput).value(c.count).type('number'),
            button('push').onclick(c.push),
            button('overwrite').onclick(c.overwrite),
            button('clear').onclick(c.clear),
            div(...c.items.map(item => div(`${c.item}`).class('box')))
        ]

    class OLoop extends XElement {
        static context = context;
        static component = component;
        static options = { root: 'this', slot: 'default' };
    }

    OLoop.define();

</script>