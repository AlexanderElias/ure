<base href="/">
<script>document.querySelector('base').href = location.hostname === 'vokeio.github.io' ? '/oxe/performance/' : '/performance/';</script>
<link rel="stylesheet" href="./index.css">

<!--
<x-child>
    <template shadowroot="open">
        <div>{{shadow}}</div>
        <slot></slot>
    </template>
</x-child>
-->

<o-loop>
    <template shadowroot="open">
        <slot></slot>
    </template>

    <div class="wrap">
        <div class="loader">Loader</div>
    </div>

    <h3><span>{{count}}</span> bound elements</h3>
    <input value="{{count = $value}}" type="number">

    <br>
    <button onclick="{{push()}}">push</button>
    <button onclick="{{overwrite()}}">overwrite</button>
    <button onclick="{{raw()}}">raw</button>
    <button onclick="{{clear()}}">clear</button>

    <div id="raw"></div>

    <div each="{{[items,'item']}}">
        <div class="box">{{item.number}}</div>
    </div>
</o-loop>

<script type="module">
    import XElement from '../x-element.js';

    // class XChild extends XElement {

    //     static observedProperties = ['self','shadow'];

    //     self='self';
    //     shadow='shadow';

    //     constructor () {
    //         super();
    //         this.setup();

    //         const template = document.createElement('template');

    //         template.innerHTML ='<div>{{self}}</div>';
    //         this.appendChild(template.content);

    //         template.innerHTML ='<div>{{shadow}}</div>';
    //         this.shadowRoot.appendChild(template.content);
    //     }

    // }

    // XChild.define();

    class OLoop extends XElement {

        static observedProperties = [
            'clear',
            'overwrite',
            'push',
            'raw',
            'one',
            'count',
            'message',
            'items'
        ];

        items = [];
        message = '';
        count = 100000;
        one = { two: 'three' };
        raw() {
            console.time('raw');
            const template = document.createElement('template');
            let html = '';
            for (var i = 0; i < this.count; i++) {
                html += `
                <div class="box">
                    <div>${i}</div>
                </div>
                `;
            }
            template.innerHTML = html;
            const raw = document.querySelector('o-loop').shadowRoot.getElementById('raw');
            raw.appendChild(template.content);
            console.timeEnd('raw');
        };
        push() {
            console.time('push');
            for (var i = 0; i < this.count; i++) {
                this.items.push({ number: i });
            }
            console.timeEnd('push');
        };
        overwrite() {
            console.time('overwrite');
            var items = [];
            for (var i = 0; i < this.count; i++) {
                items.push({ number: i });
            }
            this.items = items;
            console.timeEnd('overwrite');
        };
        clear() {
            this.items = [];
        };

        // html = /*html*/ `
        //     <link rel="stylesheet" href="./index.css">

        //     <div class="wrap">
        //         <div class="loader">Loader</div>
        //     </div>

		// 	<h3><span>{{count}}</span> bound elements</h3>
		// 	<input value="{{count = $value}}" type="number">

		// 	<br>
		// 	<button onclick="{{push()}}">push</button>
		// 	<button onclick="{{overwrite()}}">overwrite</button>
		// 	<button onclick="{{raw()}}">raw</button>
		// 	<button onclick="{{clear()}}">clear</button>

		// 	<div id="raw"></div>

		// 	<div each="{{[items,'item']}}">
        //         <div class="box">{{item.number}}</div>
        //     </div>
		// `;

        constructor () {
            super();
            this.setup();
            // this.shadowRoot.innerHTML = this.html;
        }

        // connectedCallback(){
        //     this.innerHTML = this.html;
        // }

    }

    OLoop.define();

</script>