/**
 * @version 9.0.1
 *
 * @license
 * Copyright (C) Alexander Elias
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/.
 *
 * @module
 */

function h(e,t){customElements.get(e)||customElements.define(e,t)}function u(e){switch(`${e}`){case"NaN":return"";case"null":return"";case"undefined":return""}switch(typeof e){case"string":return e;case"number":return`${e}`;case"bigint":return`${e}`;case"boolean":return`${e}`;case"function":return`${e()}`;case"symbol":return String(e);case"object":return JSON.stringify(e)}throw new Error("XElement - display type not handled")}var P=()=>Math.floor(Math.random()*Date.now());var v=function(e,...t){for(;e.lastChild;)e.removeChild(e.lastChild);if(t?.length)for(let n of t)e.appendChild(typeof n=="string"?e.ownerDocument.createTextNode(n):n)},b=function(e,t){return e.indexOf(t)!==-1},L="trustedTypes"in window?window.trustedTypes.createPolicy("x-element",{createHTML:e=>e}):void 0,O=function(e){return L?L.createHTML(e):e};var m=Symbol("html"),$=new WeakMap;function f(e,...t){let n=$.get(e);if(n){let[i,r]=n;return{strings:e,template:i,expressions:t,symbol:m,marker:r}}else{let i=`X-${P()}-X`,r="",o=e.length-1;for(let a=0;a<o;a++)r+=`${e[a]}${i}`;r+=e[o];let s=document.createElement("template");return s.innerHTML=O(r),$.set(e,[s,i]),{strings:e,template:s,expressions:t,symbol:m,marker:i}}}var ee=NodeFilter.SHOW_ELEMENT+NodeFilter.SHOW_TEXT,H=["src","href","data","action","srcdoc","xlink:href","cite","formaction","ping","poster","background","classid","codebase","longdesc","profile","usemap","icon","manifest","archive"],te=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i,X=function(e){return e===""||typeof e!="string"?!1:!te.test(e)},ne=function(e,t){let n=t.previousSibling;for(;n!==e;)n?.parentNode?.removeChild(n),n=t.previousSibling},D=function(e,t){if(t?.symbol===m)if(e=e??{},t=t??{},e.strings===t.strings){let n=this.actions.length;for(let i=0;i<n;i++)this.actions[i](e.expressions[i],t.expressions[i])}else{this.actions.length=0;let n=t.template.content.cloneNode(!0);k(n,this.actions,t.marker);let i=this.actions.length;for(let r=0;r<i;r++)this.actions[r](e.expressions?.[r],t.expressions[r]);document.adoptNode(n),ne(this.start,this.end),this.end.parentNode?.insertBefore(n,this.end)}else if(t?.constructor===Array){e=e??[],t=t??[];let n=e.length,i=t.length,r=Math.min(n,i);for(let o=0;o<r;o++)this.actions[o](e[o],t[o]);if(n<i){let o=document.createElement("template");for(let s=n;s<i;s++){let a=document.createTextNode(""),c=document.createTextNode(""),l=D.bind({start:a,end:c,actions:[]});o.content.appendChild(a),o.content.appendChild(c),this.actions.push(l),l(e[s],t[s])}this.end.parentNode?.insertBefore(o.content,this.end)}else if(n>i){for(let o=n-1;o>i-1;o--)if(e[o]?.symbol===m){let{template:s}=e[o],a=s.content.childNodes.length+2;for(;a--;)this.end.parentNode?.removeChild(this.end.previousSibling)}else this.end.parentNode?.removeChild(this.end.previousSibling),this.end.parentNode?.removeChild(this.end.previousSibling),this.end.parentNode?.removeChild(this.end.previousSibling);this.actions.length=i}}else{if(e===t)return;if(typeof e!=typeof t)for(;this.end.previousSibling!==this.start;)this.end.parentNode?.removeChild(this.end.previousSibling);let n;this.end.previousSibling===this.start?(n=document.createTextNode(u(t)),this.end.parentNode?.insertBefore(n,this.end)):this.end.previousSibling?.nodeType===Node.TEXT_NODE?(n=this.end.previousSibling,n.textContent=u(t)):(n=document.createTextNode(u(t)),this.end.parentNode?.removeChild(this.end.previousSibling),this.end.parentNode?.insertBefore(n,this.end))}},oe=function(e,t){e!==t&&(e?.startsWith("on")&&typeof this.value=="function"&&this.element.removeEventListener(e.slice(2),this.value),Reflect.set(this.element,e,void 0),this.element.removeAttribute(e),this.name=t?.toLowerCase(),this.name&&(this.element.setAttribute(this.name,""),Reflect.set(this.element,this.name,!0)))},ie=function(e,t){if(e!==t)if(this.name==="value"){if(this.value=u(t),!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else if(this.name.startsWith("on")){if(!this.name)return;if(typeof this.value=="function"&&this.element.removeEventListener(this.name.slice(2),this.value,!0),this.value=t,typeof this.value!="function")return console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);this.element.addEventListener(this.name.slice(2),this.value,!0)}else if(b(H,this.name)){if(this.value=encodeURI(t),!this.name)return;if(X(this.value)){this.element.removeAttribute(this.name),console.warn(`XElement - attribute name "${this.name}" and value "${this.value}" not allowed`);return}Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}else{if(this.value=t,!this.name)return;Reflect.set(this.element,this.name,this.value),this.element.setAttribute(this.name,this.value)}},se=function(e,t){if(e===t)return;let n=this.element;if(t){n.parentNode?.removeChild(n);let i=document.createElement(t);for(;n.firstChild;)i.appendChild(n.firstChild);if(n.nodeType===Node.ELEMENT_NODE){let r=n.getAttributeNames();for(let o of r){let s=n.getAttribute(o)??"";i.setAttribute(o,s)}}this.holder.parentNode?.insertBefore(i,this.holder),this.element=i}else n.parentNode?.removeChild(n),this.element=n},k=function(e,t,n){let i=new WeakSet,r=document.createTreeWalker(document,ee,null);r.currentNode=e;let o=e.firstChild;for(;o=r.nextNode();)if(i.has(o.previousSibling)&&(i.delete(o.previousSibling),t.push(()=>{})),o.nodeType===Node.TEXT_NODE){let s=o.nodeValue?.indexOf(n)??-1;if(s===-1)continue;s!==0&&(o.splitText(s),o=r.nextNode());let a=n.length;a!==o.nodeValue?.length&&o.splitText(a);let c=document.createTextNode(""),l=o;l.textContent="",l.parentNode?.insertBefore(c,l),t.push(D.bind({marker:n,start:c,end:l,actions:[]}))}else if(o.nodeType===Node.ELEMENT_NODE){(o.nodeName==="SCRIPT"||o.nodeName==="STYLE")&&r.nextSibling();let s={element:o};o.nodeName===n&&(i.add(o),s.holder=document.createTextNode(""),o.parentNode?.insertBefore(s.holder,o),t.push(se.bind(s)));let a=o.getAttributeNames();for(let c of a){let l=o.getAttribute(c)??"",A=c.toUpperCase().includes(n),S=l.includes(n);if(A||S){let M={name:c,value:l,previous:void 0,get element(){return s.element}};A&&(o.removeAttribute(c),t.push(oe.bind(M))),S&&(o.removeAttribute(c),t.push(ie.bind(M)))}else b(H,c)?X(l)&&(o.removeAttribute(c),console.warn(`XElement - attribute name "${c}" and value "${l}" not allowed`)):c.startsWith("on")&&(o.removeAttribute(c),console.warn(`XElement - attribute name "${c}" not allowed`))}}else console.warn(`XElement - node type "${o.nodeType}" not handled`)},j=k;var W=function(e,t,n,i,r){if(typeof n=="symbol")return Reflect.set(t,n,i,r);let o=Reflect.get(t,n,r);return o===i||Number.isNaN(o)&&Number.isNaN(i)||(Reflect.set(t,n,i,r),e()),!0},V=function(e,t,n,i){if(typeof n=="symbol")return Reflect.get(t,n,i);let r=Reflect.get(t,n,i);if(r){if(r.constructor===Function)return new Proxy(r,{apply(o,s,a){return Reflect.apply(o,i,a)}});if(r.constructor===Object||r.constructor===Array)return new Proxy(r,{get:V.bind(null,e),set:W.bind(null,e),deleteProperty:B.bind(null,e)})}return r},B=function(e,t,n){return typeof n=="symbol"?Reflect.deleteProperty(t,n):(Reflect.deleteProperty(t,n),e(),!0)},re=function(e,t){return new Proxy(e,{get:V.bind(null,t),set:W.bind(null,t),deleteProperty:B.bind(null,t)})},_=re;function p(e){return e=e.replace(/([a-zA-Z])([A-Z])/g,"$1-$2"),e=e.toLowerCase(),e=e.includes("-")?e:`x-${e}`,e}var F=new Event("adopted"),I=new Event("adopting"),we=new Event("upgraded"),Ce=new Event("upgrading"),q=new Event("creating"),U=new Event("created"),K=new Event("rendering"),z=new Event("rendered"),x=new Event("connected"),g=new Event("connecting"),Z=new Event("attributed"),G=new Event("attributing"),J=new Event("disconnected"),Y=new Event("disconnecting");var y=Symbol("Task"),w=Symbol("Create"),Q=Symbol("Setup"),E=Symbol("Update"),d=class extends HTMLElement{static html=f;static define(t=this.tag??this.name){return t=p(t),h(t,this),this}static async create(t=this.tag??this.name){t=p(t),h(t,this);let n=document.createElement(t);return await n[w],n}static tag;static shadow;static mode;static observedProperties;#e={};#s;#r="";#t=[];#i=[];#n=!1;#o=!1;#a=!1;[y]=Promise.resolve();constructor(){super();let t=this.constructor;if(t.shadow&&!this.shadowRoot){let i=t.mode||"open";this.attachShadow({mode:i})}this.#s=this.shadowRoot??this}async attributeChangedCallback(t,n,i){this.dispatchEvent(G),await this.attribute?.(t,n,i)?.catch(console.error),this.dispatchEvent(Z)}async adoptedCallback(){this.dispatchEvent(I),await this.adopted?.(this.#e)?.catch(console.error),this.dispatchEvent(F)}async connectedCallback(){this.#a?(this.dispatchEvent(g),await this.connected?.(this.#e)?.catch(console.error),this.dispatchEvent(x)):await this[w]()}async disconnectedCallback(){this.dispatchEvent(Y),await this.disconnected?.(this.#e)?.catch(console.error),this.dispatchEvent(J)}async[w](){this.#a=!0,this.#n=!0,await this[Q](),this.dispatchEvent(q),await this.created?.(this.#e),this.dispatchEvent(U),this.dispatchEvent(g),await this.connected?.(this.#e)?.catch(console.error),this.dispatchEvent(x),this.#n=!1,this.#o=!1,await this[E]()}async[E](){return this.#n?(this.#o=!0,this[y]):(this.#n=!0,this[y]=this[y].then(async()=>{this.dispatchEvent(K);let t=await this.render?.(this.#e);if(t)for(let n=0;n<this.#t.length;n++){if(this.#o){await Promise.resolve().then().catch(console.error),n=-1,this.#o=!1;continue}let i=t.expressions[n],r=this.#i[n];try{this.#t[n](r,i)}catch(o){console.error(o)}this.#i[n]=t.expressions[n]}this.#n=!1,await this.rendered?.(this.#e),this.dispatchEvent(z)}).catch(console.error),this[y])}async[Q](){let n=this.constructor.observedProperties,i=Object.getPrototypeOf(this),r=n?n??[]:[...Object.getOwnPropertyNames(this),...Object.getOwnPropertyNames(i)];for(let s of r){if(s==="attributeChangedCallback"||s==="disconnectedCallback"||s==="connectedCallback"||s==="adoptedCallback"||s==="constructor"||s==="disconnected"||s==="attribute"||s==="connected"||s==="rendered"||s==="created"||s==="adopted"||s==="render"||s==="setup")continue;let a=Object.getOwnPropertyDescriptor(this,s)??Object.getOwnPropertyDescriptor(i,s);a&&a.configurable&&(typeof a.value=="function"&&(a.value=a.value.bind(this)),typeof a.get=="function"&&(a.get=a.get.bind(this)),typeof a.set=="function"&&(a.set=a.set.bind(this)),Object.defineProperty(this.#e,s,a),Object.defineProperty(this,s,{enumerable:a.enumerable,configurable:!1,get(){return this.#e[s]},set(c){this.#e[s]=c,this[E]()}}))}this.#e=_(this.#e,this[E].bind(this));let o=await this.render?.(this.#e);if(o){let s=o.template.content.cloneNode(!0);this.#r=o.marker,this.#i=o.expressions,j(s,this.#t,this.#r);for(let a=0;a<this.#t.length;a++){let c=o.expressions[a];try{this.#t[a](void 0,c)}catch(l){console.error(l)}}document.adoptNode(s),this.#s.appendChild(s)}}};var N=[],T=[],C=async function(e){if(e.instance)v(e.root,e.instance);else{let t=await e.handler();if(t?.prototype instanceof HTMLElement)e.construct=t;else if(t?.default?.prototype instanceof HTMLElement)e.construct=t.default;else throw new Error("XElement - router handler requires a CustomElementConstructor");e.construct.prototype instanceof d?e.instance=await e.construct.create():(e.tag=p(e.construct.tag??e.construct.name),h(e.tag,e.construct),e.instance=document.createElement(e.tag)),v(e.root,e.instance)}},ae=function(e){if(e&&"canIntercept"in e&&e.canIntercept===!1||e&&"canTransition"in e&&e.canTransition===!1)return;let t=new URL(e?.destination.url??location.href),n=new URL(document.querySelector("base")?.href??location.origin);n.hash="",n.search="",t.hash="",t.search="";let i=t.href.replace(n.href,"/"),r=[];for(let o of T)o.path===i&&r.push(o);for(let o of N){let s=!1;for(let a of r)if(a.root===o.root){s=!0;break}s||r.push(o)}if(e?.intercept)return e.intercept({handler:()=>r.map(o=>C(o))});if(e?.transitionWhile)return e.transitionWhile(r.map(o=>C(o)));r.map(o=>C(o))},ce=function(e,t,n){if(!e)throw new Error("XElement - router path required");if(!n)throw new Error("XElement - router handler required");if(!t)throw new Error("XElement - router root required");if(e==="/*"){for(let i of N)if(i.path===e&&i.root===t)throw new Error("XElement - router duplicate path on root");N.push({path:e,root:t,handler:n})}else{for(let i of T)if(i.path===e&&i.root===t)throw new Error("XElement - router duplicate path on root");T.push({path:e,root:t,handler:n,instance:void 0})}Reflect.get(window,"navigation").addEventListener("navigate",ae)},R=ce;var Ve={Component:d,component:d,Router:R,router:R,html:f};export{d as Component,R as Router,d as component,Ve as default,f as html,R as router};
//# sourceMappingURL=esnext.min.js.map
